/*
 * Name: [Project name]
 * Version: 1.0
 * Owner: Corporate Webmaster (NUS_N_NIWWW)
 * Copyright (c) 2013 IBM Corporation
 */

// URI: [File location on live site]
// Description: [JS Customization for "Project name"]
// Author: [Name and Lotus Notes address of JS author]
// Date: [Date of file edits] (e.g. July 30, 2013)

// $(document).ready(function(){
// 	console.log("DOM READY");
	
// 		// $("#ibm_cci-widget-js").masonry({
// 		// 	gutter: 0,
// 		// 	itemSelector: '.ibm-card',
// 		// 	transitionDuration: '1s',
// 		// 	isAnimated: true
// 		// }, true);
// });

var colCount = 0;
var colWidth = 320;
var margin = 0;
var spaceLeft = 0;
var windowWidth = 0;
var blocks = [];

$(function(){
	$(window).resize(setupBlocks);
});

function setupBlocks() {
	windowWidth = $("#ibm_cci-widget-js").width();
	console.log("conatainer width value: " + windowWidth);
	blocks = [];

	// Calculate the margin so the blocks are evenly spaced within the window
	colCount = Math.floor(windowWidth/(colWidth+margin));
	console.log("colCount val: " + colCount);
	spaceLeft = (windowWidth - ((colWidth*colCount)+(margin*(colCount-1)))) / 2;
	console.log("spaceleft: " + spaceLeft);
	
	for(var i=0;i<colCount;i++){
		blocks.push(margin);
	}
	console.log("margin: " + margin);
	positionBlocks();
}

function positionBlocks() {
	$('.ibm-col-1-1').each(function(i){
		var min = Array.min(blocks);
		console.log("min value: " + min);
		
		var index = $.inArray(min, blocks);
		console.log("index value: " + index);
		
		var leftPos = margin+(index*(colWidth+margin));
		console.log("leftPos value: " + leftPos);
		
		$(this).css({
			'left':(leftPos+spaceLeft)+'px',
			'top':min+'px'
		});
		blocks[index] = min+$(this).height()+margin + 20;
		console.log(blocks);
	});	
}

// Function to get the Min value in Array
Array.min = function(array) {
    return Math.min.apply(Math, array);
}; 