/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/

/*
	This is an optimized version of Dojo, built for deployment and not for
	development. To get sources and documentation, please visit:

		http://dojotoolkit.org
*/

if(!dojo._hasResource["ibm.v17e.voices.ioc"]){dojo._hasResource["ibm.v17e.voices.ioc"]=true;dojo.provide("ibm.v17e.voices.ioc");(function(){dojo.declare("ibm.v17e.voices.ioc",null,{subscriptions:{"/voices/more":"moreData","/voices/rpc":"rpc","/voices/search":"search"},constructor:function(_1){this._subscriptions=[];this._connects=[];this.config=_1;for(var _2 in this.subscriptions){this._subscriptions.push(dojo.subscribe(this.config.topicPrefix+_2,this,this.subscriptions[_2]));}this.cRequest=this.buildCReq();dojo.addOnUnload(dojo.hitch(this,"destroy"));},destroy:function(){dojo.forEach(this._subscriptions,dojo.unsubscribe);dojo.forEach(this._connects,dojo.disconnect);},send:function(_3){var _4=this;var _5={url:this.config.socketUrl+"&cometRequest="+encodeURIComponent(dojo.toJson(_3)),callbackParamName:"callback",preventCache:true,load:dojo.hitch(this,"onMsg"),error:function(_6){console.error("[IOC] onJSONPError",dojo.toJson(_6));}};return dojo.io.script.get(_5);},onMsg:function(_7){try{if(!_7){return;}var m=typeof _7=="string"?dojo.fromJson(_7):_7;if(!m){return;}if(m.searchResponse){dojo.publish(this.config.topicPrefix+"/feed/procResp",[m]);this.cRequest.action="update";}if(m.status){console.error(dojo.toJson(m));return;}}catch(e){console.error("onMsg: "+dojo.toJson(e));}},search:function(_8){try{this.buildSearch(this.cRequest.searchCriteria,_8);this.cRequest.action="search";this.send(this.cRequest);if(_8&&_8.length>0){var _9=_8.split(",");for(var i=0;i<_9.length;i++){ibm.v17e.voices.utils.analytics.log("Search","Term",_9[i]);}}}catch(e){console.error("Search query failed error="+e+" query="+dojo.toJson(_8));}},rpc:function(_a){var _b={};_b.siteId=this.config.siteId;_b.action="rpc";_b.rpc={};_b.rpc.method=_a.method;_b.rpc.type=_a.type;_b.rpc.id=_a.target;this.send((_b));},moreData:function(_c){var _d=dojo.clone(this.cRequest);_d.action="loadMore";_d.searchCriteria.voices.published=_c.published;_d.searchCriteria.voices.score=_c.score;this.send(_d);},buildCReq:function(){var _e={};_e.siteId=this.config.siteId;_e.searchCriteria={};_e.searchCriteria.noFilter=true;_e.searchCriteria.voices={};_e.searchCriteria.voices.noOfItems=20;this.buildSearch(_e.searchCriteria,this.config.filter);return _e;},buildSearch:function(sc,_f){sc.noFilter=true;sc.filter=sc.fromDate=sc.feeds=null;if(!_f){return;}try{_f=dojo.trim(_f.toLowerCase().replace(/\s+/g," "));if(!_f||_f.length<=0){return;}var _10=_f.split(/\s+/g);var i=0;while(i<_10.length){try{if(_10[i].indexOf("feeds:",0)==0){var _11=_10[i].substr(6);if(_11&&_11.trim().length>0){sc.feeds=_11.trim().split(",");}}else{if(_10[i].indexOf("fromdate:",0)==0){var _11=_10[i].substr(9);if(_11&&_11.trim().length>0){_11=_11.trim()+" 23:59:59";sc.fromDate=dojo.date.locale.parse(_11,{datePattern:"MM/dd/yyyy",timePattern:"HH:mm:ss"}).getTime();sc.fromDate+=10;}}else{if(_10[i].indexOf("keyword:",0)==0){_10[i]=_10[i].replace("keyword:","");}if(sc.filter){sc.filter+=" "+_10[i];}else{sc.filter=_10[i];}}}}catch(e){console.warn("Search string="+_f+" error="+e);}i++;}if(sc.filter){sc.filter=sc.filter.trim();if(sc.filter.length<=0){delete sc.filter;}else{sc.filter=sc.filter.replace(/\s+/g," ");}}if(sc.filter||sc.fromDate||sc.feeds){sc.noFilter=false;}}catch(err){console.error("Filter: "+_f+" error: "+dojo.toJson(err));}}});})();}if(!dojo._hasResource["ibm.v17e.voices.widget.konst"]){dojo._hasResource["ibm.v17e.voices.widget.konst"]=true;dojo.provide("ibm.v17e.voices.widget.konst");ibm.v17e.voices.widget.konst={SERVER_BASE:dojo.config.voicesServiceBase,BLOGS:"BLOGS",TWITTER:"TWITTER",VIDEOS:"VIDEOS",ALL:"ALL",GRID:"GRID",LIST:"LIST",IS_MOBILE:dojo.global.navigator?dojo.global.navigator.userAgent.search(/android|ipad|iphone|playbook|rim\ |blackberry|mobile/gi)!=-1:false,isAndroidPhone:function(){return dojo.global.navigator?dojo.global.navigator.userAgent.match(/(Android)(mobile)/gi):false;},isAndroidTablet:function(){if(dojo.global.navigator?dojo.global.navigator.userAgent.match(/Android/i):false){if(!dojo.global.navigator.userAgent.match(/mobile/gi)){return true;}}return false;},isRIM:function(){return dojo.global.navigator?dojo.global.navigator.userAgent.match(/rim/i):false;},isBlackBerry:function(){return dojo.global.navigator?dojo.global.navigator.userAgent.match(/BlackBerry/i):false;},isIOSphone:function(){return dojo.global.navigator?dojo.global.navigator.userAgent.match(/iPhone|iPod/i):false;},isIOStablet:function(){return dojo.global.navigator?dojo.global.navigator.userAgent.match(/iPad/i):false;},isOpera:function(){return dojo.global.navigator?dojo.global.navigator.userAgent.match(/Opera Mini/i):false;},isWindows:function(){return dojo.global.navigator?dojo.global.navigator.userAgent.match(/IEMobile/i):false;},isMobile:function(){if(ibm.voices.widget.konst.isMobilePhone()||ibm.voices.widget.konst.isTablet()){return true;}return false;},isTablet:function(){return (ibm.voices.widget.konst.isAndroidTablet()||ibm.voices.widget.konst.isIOStablet());},isMobilePhone:function(){return (ibm.voices.widget.konst.isAndroidPhone()||ibm.voices.widget.konst.isRIM()||ibm.voices.widget.konst.isBlackBerry()||ibm.voices.widget.konst.isIOSphone()||ibm.voices.widget.konst.isOpera()||ibm.voices.widget.konst.isWindows());}};}if(!dojo._hasResource["ibm.v17e.voices.widget.handler"]){dojo._hasResource["ibm.v17e.voices.widget.handler"]=true;dojo.provide("ibm.v17e.voices.widget.handler");ibm.v17e.voices.widget.handler={flag:function(evt){if(evt){dojo.stopEvent(evt);}var _12=new dojo.NodeList(evt.target).closest(".voicesItem")[0];var d=showConfirmDialog("Confirm","Is this content inappropriate?");dojo.when(d,dojo.hitch(this,function(){dojo.fx.wipeOut({node:_12}).play();var msg={type:this.feed.type||"Blogs",target:dojo.attr(_12,"data-id"),method:"flag"};dojo.publish(this.config.topicPrefix+"/voices/rpc",[msg]);}));},visit:function(evt){var a=evt.target.tagName=="A"?evt.target:evt.target.parentNode;},twitterAction:function(evt){if(evt){dojo.stopEvent(evt);}try{var _13=dojo.attr(evt.target,"data-action");if(!_13){_13=dojo.attr(evt.target.parentElement,"data-action");}if(!_13){return;}var _14,_15="dnt=true&count=none",_16={ibmEvGroup:"Twitter"};try{if(this.config){_15=this.config.tQuery;}else{_15=ibm.SMA.config.tQuery;}}catch(ee){}if(_13=="twitter.fav"||_13=="twitter.retweet"||_13=="twitter.reply"){var _17=new dojo.NodeList(evt.target).closest(".voicesItem")[0];var id=dojo.attr(_17,"data-id");var _18=dojo.query(".timelink",_17)[0].href;_16.ibmEvAction=_18||"none";if(_13=="twitter.fav"){_14="//twitter.com/intent/favorite?tweet_id="+id+"&"+_15;_16.ibmEV="Fav";}else{if(_13=="twitter.retweet"){_14="//twitter.com/intent/retweet?tweet_id="+id+"&"+_15;_16.ibmEV="Retweet";}else{if(_13=="twitter.reply"){_14="//twitter.com/intent/tweet?in_reply_to="+id+"&"+_15;_16.ibmEV="Reply";}}}}else{if(_13=="twitter.tweet"){_14="//twitter.com/intent/tweet?"+_15;_16.ibmEV="Tweet";_16.ibmEvAction="none";}else{if(_13=="twitter.profile"){var _19=dojo.attr(evt.target,"data-user-id");if(!_19){_19=dojo.attr(evt.target.parentElement,"data-user-id");}_14="//twitter.com/intent/user?user_id="+_19+"&"+_15;var _17=new dojo.NodeList(evt.target).closest(".voicesItem")[0];_16.ibmEV="Profile";_16.ibmEvAction="none";if(dojo.query(".namelink > strong",_17)[0]){_16.ibmEvAction=dojo.query(".namelink > strong",_17)[0].innerHTML;}else{if(dojo.query(".handlelink",_17)[0]){_16.ibmEvAction=dojo.query(".handlelink",_17)[0].innerHTML;}}}}}if(_14){ibm.v17e.voices.widget.handler.openwindow.call(this,_14);ibm.v17e.voices.utils.analytics.logEV(_16);}}catch(e){console.error(e);}},twitterProcessContent:function(_1a){try{var _1b=_1a.innerHTML;var _1c=dojo.query(">p",_1a)[0];if(_1c){_1b=_1c.innerHTML;}var tmp=ibm.v17e.voices.widget.handler.twitterTextProcess(_1b);_1a.innerHTML="<p>"+tmp+"</p>";}catch(e){console.error("twitterProcessContent - "+dojo.toJson(e));}},twitterTextProcess:function(_1d){try{var tmp=_1d.replace(/(http(s)*\:\/\/[^\s]+\s*)/g,"<a href=\"$1\" data-action=\"new-tab\">$1</a>").replace(/#([^\s]+)/g,"<a href=\"//twitter.com/search?q=%23$1\" data-action=\"new-tab\">#$1</a>").replace(/@([^\s:]+)/g,"<a href=\"//twitter.com/$1\" data-action=\"new-tab\">@$1</a>");return tmp;}catch(e){console.error("twitterProcessContent - "+dojo.toJson(e));}},trimString:function(str){str=str.replace(/^\s+/,"");for(var i=str.length-1;i>=0;i--){if(/\S/.test(str.charAt(i))){str=str.substring(0,i+1);break;}}return str;},prettyDate:function(_1e){var _1f=new Array();_1f[0]="Jan";_1f[1]="Feb";_1f[2]="Mar";_1f[3]="Apr";_1f[4]="May";_1f[5]="Jun";_1f[6]="Jul";_1f[7]="Aug";_1f[8]="Sep";_1f[9]="Oct";_1f[10]="Nov";_1f[11]="Dec";_1f[12]="December";var _20=dojo.attr(_1e,"data-timeval");var _21=new Date((parseInt(_20.trim())||"")),_22=(((new Date()).getTime()-_21.getTime())/1000),_23=Math.floor(_22/86400);if(isNaN(_23)||_23<0){return;}_1e.innerHTML=_23==0&&(_22<60&&"just now"||_22<120&&"1m"||_22<3600&&Math.floor(_22/60)+"m"||_22<7200&&"1h"||_22<86400&&Math.floor(_22/3600)+"h")||_23>=1&&_23+"d";},prettyDateVal:function(_24){var _25=new Array();_25[0]="Jan";_25[1]="Feb";_25[2]="Mar";_25[3]="Apr";_25[4]="May";_25[5]="Jun";_25[6]="Jul";_25[7]="Aug";_25[8]="Sep";_25[9]="Oct";_25[10]="Nov";_25[11]="Dec";_25[12]="December";_24=_24+"";var _26=new Date((parseInt(_24.trim())||"")),_27=(((new Date()).getTime()-_26.getTime())/1000),_28=Math.floor(_27/86400);if(isNaN(_28)||_28<0){return;}var _29=_28==0&&(_27<60&&"just now"||_27<120&&"1m"||_27<3600&&Math.floor(_27/60)+"m"||_27<7200&&"1h"||_27<86400&&Math.floor(_27/3600)+"h")||_28>=1&&_28+"d";return _29;},youtubeAction:function(evt){if(evt){dojo.stopEvent(evt);}try{var _2a=dojo.attr(evt.target,"data-action");if(!_2a){_2a=dojo.attr(evt.target.parentElement,"data-action");}if(!_2a){return;}var _2b="";var _2c=new dojo.NodeList(evt.target).closest(".voicesItem")[0];var _2d=dojo.attr(_2c,"data-id");var _2e=dojo.attr(_2c,"data-channel-id");if(_2a=="youtube.channel"){_2b="//www.youtube.com/channel/"+_2e;}else{if(_2a=="youtube.video"){_2b="//www.youtube.com/watch?v="+_2d;}}window.open(_2b,"_blank");}catch(e){console.error("youtubeAction failed: "+dojo.toJson(e));}},youtubePlay:function(evt){if(evt){dojo.stopEvent(evt);}},showResolvedDetailsonGrid:function(_2f){try{var _30=dojo.attr(_2f,"data-content-type");var _31=dojo.attr(_2f,"data-content-url");var _32=dojo.query(".details",_2f)[0];var _33=dojo.attr(_32,"data-url-content");_33=_33.substring(_33.indexOf("//"));var _34=dojo.attr(_32,"data-media-url");if(!dojo.hasClass(_32,"open")){var _35="";if(_30.indexOf("youtube")>-1){_35="<div class=\"ibm-media\"><div class=\"ibm-video\"><div class=\"ibm-container-body\" dojoattachpoint=\"bodyNode\">"+"<div class=\"ibm-video-container\" dojoattachpoint=\"containerNode\"><object class=\"player\" style=\"height: 293px; width: 270px\">"+"<param name=\"movie\" value=\"${urlContent}\"><param name=\"allowFullScreen\" value=\"true\">"+"<param name=\"allowScriptAccess\" value=\"always\"><embed data-action=\"youtube.play\" width=\"270\" height=\"293\" src=\"${urlContent}\" type=\"application/x-shockwave-flash\" allowfullscreen=\"true\" allowscriptaccess=\"always\" alt=\"&nbsp;\">"+"</object></div></div></div></div>";_35=dojo.string.substitute(_35,{urlContent:_33});}else{if(_30.indexOf("flickr")>-1){_35="<p class=\"ibm-custom-embed-image\"><a data-action=\"new-tab\" target=\"_blank\" href=\"${url}\">"+"<img alt=\"\" src=\"${urlContent}\"></a></p>";_35=dojo.string.substitute(_35,{urlContent:_33,url:_31});}else{if(_34&&_34!=""){ibm.v17e.voices.widget.handler.setMediaImage(_34,_32);}}}_32.innerHTML=_35;}else{_32.innerHTML="";}dojo.query(".channel .blognamelink",_2f).forEach(function(_36){var _37=ibm.v17e.voices.widget.handler.processDomain(_36.innerHTML);_36.innerHTML=_37;});dojo.query(".more p a",_2f).toggleClass("on");dojo.toggleClass(_32,"open");}catch(e){console.error("showResolvedDetailsonGrid failed: "+dojo.toJson(e));}},setMediaImage:function(url,_38){var _39=new Image();var _3a=dojo.connect(_39,"load",function(evt){if(evt.target.width>199){_38.innerHTML="<p class=\"ibm-custom-embed-image\">"+"<img alt=\"\" src=\""+url+"\"></p>";}dojo.disconnect(_3a);});_39.src=url;},toggleResolvedDetails:function(evt){if(evt){dojo.stopEvent(evt);}var _3b=new dojo.NodeList(evt.target).closest(".tweetresolved")[0];var _3c=dojo.attr(_3b,"data-action");if(!_3c){_3c=dojo.attr(evt.target.parentElement,"data-action");}if(!_3c){return;}try{var _3d=dojo.attr(_3b,"data-content-type");var _3e=dojo.attr(_3b,"data-content-url");var _3f=dojo.query(".details",_3b)[0];var _40=dojo.attr(_3f,"data-url-content");_40=_40.substring(_40.indexOf("//"));if(!dojo.hasClass(_3f,"open")){var _41="";if(_3d.indexOf("youtube")>-1){_41="<div class=\"ibm-media\"><div class=\"ibm-video\"><div class=\"ibm-container-body\" dojoattachpoint=\"bodyNode\">"+"<div class=\"ibm-video-container\" dojoattachpoint=\"containerNode\"><object class=\"player\" style=\"height: 293px; width: 520px\">"+"<param name=\"movie\" value=\"${urlContent}\"><param name=\"allowFullScreen\" value=\"true\">"+"<param name=\"allowScriptAccess\" value=\"always\"><embed data-action=\"youtube.play\" width=\"520\" height=\"293\" src=\"${urlContent}\" type=\"application/x-shockwave-flash\" allowfullscreen=\"true\" allowscriptaccess=\"always\" alt=\"&nbsp;\">"+"</object></div></div></div></div>";_41=dojo.string.substitute(_41,{urlContent:_40});}else{if(_3d.indexOf("flickr")>-1){_41="<p><a data-action=\"new-tab\" target=\"_blank\" href=\"${url}\">"+"<img alt=\"\" src=\"${urlContent}\"></a></p>";_41=dojo.string.substitute(_41,{urlContent:_40,url:_3e});}else{_41="<p>${urlContent}&nbsp;<a data-action=\"new-tab\" target=\"_blank\" class=\"blognamelink\" href=\"${url}\">READ MORE</a></p>";_41=dojo.string.substitute(_41,{urlContent:_40,url:_3e});}}_3f.innerHTML=_41;}else{_3f.innerHTML="";}dojo.query(".more p a",_3b).toggleClass("on");dojo.toggleClass(_3f,"open");}catch(e){console.error("toggleResolvedDetails failed: "+dojo.toJson(e));}},toggleViewSelection:function(evt){try{var _42=dojo.attr(evt.target,"data-action");dojo.addClass(evt.target,"selected");if(_42.indexOf("GRID")>-1){var _43=dojo.query(".ibm_cci--ls--toggle--li--list-icon a",dojo.global.window.document)[0];dojo.removeClass(_43,"selected");ibm.v17e.voices.utils.analytics.log("View","click","Grid");}else{if(_42.indexOf("LIST")>-1){var _44=dojo.query(".ibm_cci--ls--toggle--li--grid-icon a",dojo.global.window.document)[0];dojo.removeClass(_44,"selected");ibm.v17e.voices.utils.analytics.log("View","click","List");}}}catch(e){console.error("Error inside toggleViewSelection : "+e);}},processImages:function(_45){try{var _46=dojo.query(".avatar",_45);if(_46[0]&&_46[0].src&&_46[0].src==_46[0].baseURI){dojo.style(_45,"display","none");}else{}}catch(e){console.error("Problem processing images for element : "+_45+" Error: "+e);}},processFaviconImages:function(_47){try{var _48=dojo.query(".ibm_cci--feed-icon img",_47)[0];if(_48){var _49=""+dojo.attr(_48,"src");if(_49.trim()==""){dojo.style(_48,"display","none");}}}catch(e){console.error("Problem processing favicon images for element : "+_47+" Error: "+e);}},correctRank:function(_4a){try{if(_4a.innerHTML.length<2){_4a.innerHTML="0"+_4a.innerHTML;}}catch(e){console.error("Problem correct Rank : "+_4a+" Error: "+e);}},shareAction:function(evt){if(evt){dojo.stopEvent(evt);}try{var _4b=dojo.attr(evt.target,"data-action");if(!_4b){_4b=dojo.attr(evt.target.parentElement,"data-action");}if(!_4b){return;}if(_4b=="twitter.share"||_4b=="facebook.share"||_4b=="linkedin.share"){var _4c=new dojo.NodeList(evt.target).closest(".voicesItem")[0];var _4d=dojo.query(".urlhrefval",_4c)[0];var _4e=dojo.attr(_4d,"href");var _4f=dojo.query(".urltitleval",_4c)[0];var _50=_4f.innerHTML;var _51={ibmEvGroup:"Share"},_52;if(_4b=="twitter.share"){_52="//twitter.com/intent/tweet?text="+encodeURIComponent(_50)+" (via@IBMvoices)"+"&url="+encodeURIComponent(_4e)+"&original_referer="+"//www.ibm.com/voices";_51.ibmEV="Twitter";}else{if(_4b=="facebook.share"){_52="//www.facebook.com/sharer.php?u="+encodeURIComponent(_4e+" "+_50);_51.ibmEV="Facebook";}else{if(_4b=="linkedin.share"){_52="//www.linkedin.com/shareArticle?mini=true&url="+encodeURIComponent(_4e)+"&summary="+_50;_51.ibmEV="LinkedIn";}}}ibm.v17e.voices.widget.handler.openwindow.call(this,_52);_51.ibmEvAction=_4e||"none";_51.ibmEvLinkTitle=_50||"none";ibm.v17e.voices.utils.analytics.logEV(_51);}}catch(e){console.error("shareAction failed: "+dojo.toJson(e));}},processDomain:function(_53){if(_53.indexOf(".com")>-1){_53=_53.replace(".com","");}if(_53.indexOf("www.")>-1){_53=_53.replace("www.","");}if(_53.indexOf(".net")>-1){_53=_53.replace(".net.","");}if(_53.indexOf(".org")>-1){_53=_53.replace(".org","");}if(_53.length>20){_53=_53.substring(0,20);}return _53;},openwindow:function(_54){var _55="scrollbars=yes,resizable=yes,toolbar=no,location=yes",_56=550,_57=420,_58=screen.height,_59=screen.width;var _5a=Math.round((_59/2)-(_56/2));var top=0;if(_58>_57){top=Math.round((_58/2)-(_57/2));}window.open(_54,"intent",_55+",width="+_56+",height="+_57+",left="+_5a+",top="+top).focus();},openNewTab:function(evt){if(evt){dojo.stopEvent(evt);}var _5b=dojo.attr(evt.target,"data-action");if(!_5b){_5b=dojo.attr(evt.target.parentElement,"data-action");}if(!_5b){return;}var _5c=dojo.attr(evt.target,"href");if(_5c==null){_5c=dojo.attr(evt.target.parentElement,"href");}if(dojo.hasClass(evt.target,"timelink")){ibm.v17e.voices.utils.analytics.log("Twitter","View",_5c);}else{var nl=dojo.NodeList(evt.target).closest(".ibm_cci--txttwt");if(nl.length>0){ibm.v17e.voices.utils.analytics.log("Twitter","Link",_5c);}else{nl=dojo.NodeList(evt.target).closest(".ibm_cci--rcb");if(nl.length>0){ibm.v17e.voices.utils.analytics.log("URLRef","View",_5c);}}}window.open(_5c,"_blank");},highlightSearchTerms:function(_5d,_5e){var _5f=[];if(_5e&&_5e.indexOf(",")>-1){_5f=_5e.split(",");}else{_5f[0]=_5e;}var _60="<span class=\"ibm_cci-search-term-highlight ${colorClass}\">";dojo.forEach(_5f,function(_61,i){var _62="";if(i>0){_62="ibm_cci-colorClass"+i;}var _63=dojo.string.substitute(_60,{colorClass:_62})+"$1</span>";var _64="("+_61.replace(/([{}()[\]\\.?*+^$|=!:~-])/gi,"$1")+")";var _65=new RegExp(_64,"gim");_5d.innerHTML=_5d.innerHTML.replace(/(>[^<]+<)/gim,function(a){return a.replace(_65,_63);});});},handleData:function(msg){var _66=this.config.viewType;var _67=null;if(msg.searchResponse.entries&&msg.searchResponse.entries.length>0){_67=msg.searchResponse.entries;}if((msg.action=="search")&&msg.searchResponse.terms&&msg.searchResponse.terms.length>0){this.searchResCount=msg.searchResponse.totalCount;var _68=dojo.query(".ibm-voices-search-result-count",this.container)[0];if(_68){dojo.place("<p>"+msg.searchResponse.totalCount+" results.</p>",_68,"last");}}try{if(_67){for(var i=0;i<_67.length;i++){try{this.itemsCount=this.itemsCount+1;var _69="";_69=_69+ibm.v17e.voices.widget.handler.renderItem.call(this,_67[i]);var _6a=dojo.create("div",{innerHTML:_69});if(this.isSearch&&msg.searchResponse.terms&&msg.searchResponse.terms.length>0){this.searchTerms=msg.searchResponse.terms;ibm.v17e.voices.widget.handler.highlightSearchTerms(_6a,this.searchTerms);_69=_6a.innerHTML;}else{this.searchTerms=null;}if(_67[i].rank&&(""+_67[i].rank).length>2){var s3=(dojo.query(".rank",_6a)[0]);dojo.addClass(s3,"reducefont");_69=_6a.innerHTML;}this._connects.push(this.connect(_69,"onclick","eventHandler"));var _6b=this.container;if(_66=="GRID"){var n1=dojo.query(".ibm-voices-grid-one",this.container)[0];var n2=dojo.query(".ibm-voices-grid-two",this.container)[0];var n3=dojo.query(".ibm-voices-grid-three",this.container)[0];var _6b=dojo.coords(n2).h<dojo.coords(n1).h?n2:n1;_6b=dojo.coords(n3).h<dojo.coords(_6b).h?n3:_6b;}dojo.place(_69,_6b,"last");var _6c=dojo.query(".voicesItem",_6b);this.lastItem=_6c[_6c.length-1];if(this.lastItem&&_67[i].type=="URLREF"&&_67[i].refTweets&&_67[i].refTweets.length>1){if(_66=="GRID"){ibm.v17e.voices.widget.handler.showResolvedDetailsonGrid(this.lastItem);}ibm.v17e.voices.widget.handler.copyRelated(this.lastItem);}dojo.query(".score>.rank>p",this.lastItem).forEach(ibm.v17e.voices.widget.handler.correctRank,this);dojo.query(".timelink",this.lastItem).forEach(ibm.v17e.voices.widget.handler.prettyDate,this);dojo.query(".thumblink",this.lastItem).forEach(ibm.v17e.voices.widget.handler.processImages,this);}catch(e){console.error("Failed to render item, err"+e+" data="+dojo.toJson(_67[i]));}}}}catch(e){console.error("Failed to render, err"+e+" data="+dojo.toJson(msg));}},renderItem:function(_6d){try{var _6e=this.config.viewType;if(_6d.type&&_6d.type=="TWEET"){_6d=this.feed.normalizeTWObj(_6d);var _6f=null;if(_6e=="GRID"){_6f=dojo.string.substitute(this.feed.templates.twitterItemGrid,{data:_6d});}else{_6f=dojo.string.substitute(this.feed.templates.twitterItem,{data:_6d});}return _6f;}else{if(_6d.type&&_6d.type=="URLREF"){var obj={link:_6d.link?""+_6d.link:"",domain:_6d.domain?""+ibm.v17e.voices.widget.handler.processDomain(_6d.domain):"",title:_6d.title?""+_6d.title:"",icon:_6d.icon?""+_6d.icon:"",content:_6d.content?""+_6d.content:"",mediaURL:_6d.mediaURL?""+_6d.mediaURL:"",refIds:_6d.refIds?""+_6d.refIds:"",score:_6d.score?""+_6d.score:("0"),reachPct:_6d.reachPct?""+_6d.reachPct:("0"),engmtPct:_6d.engmtPct?""+_6d.engmtPct:("0"),ampPct:_6d.ampPct?""+_6d.ampPct:("0"),reach:_6d.reach?""+_6d.reach:("0"),amp:_6d.amp?""+_6d.amp:("0"),engmt:_6d.engmt?""+_6d.engmt:("0"),rank:_6d.rank?""+_6d.rank:("0"),published:_6d.published?""+_6d.published:parseFloat("0"),refTweets:"",refIds:"",refUsers:"",type:""+_6d.type};var _70=this.feed.templates.twitterResolvedItem;if(_6e=="GRID"){_70=this.feed.templates.twitterResolvedItemGrid;}var _6f=dojo.string.substitute(_70,{data:obj,currDataId:_6d.refTweets[0].id,currPublished:""+_6d.refTweets[0].published,currUserId:""+_6d.refTweets[0].userId,currUserName:""+_6d.refTweets[0].username,currUserScreenName:""+_6d.refTweets[0].userScreenName,currUserAvatar:""+_6d.refTweets[0].userAvatar,currPublishedStr:""+_6d.refTweets[0].publishedStr,currLink:""+_6d.refTweets[0].link,currContent:""+ibm.v17e.voices.widget.handler.twitterTextProcess(_6d.refTweets[0].content)});if(_6d.refTweets&&_6d.refTweets.length>1){var _71=10;if(_6d.refTweets.length<10){_71=_6d.refTweets.length;}var _72="<div class=\"row  ibm_cci-related-main-div relatedinitialhide\" id=\""+_6d.rank+"-"+_6d.refTweets[0].id+"-relatedTweets\"><ul class=\"ibm_cci-relatedTweetContainer\">";for(var xn=0;xn<_71;xn++){var _73=_6d.refTweets[xn].published+"";var _74="<img class=\"thumb\" alt=\"";if(xn==0){_74="<img class=\"thumb active\" alt=\"";}var _75="<li class=\"relatedTweetitem\" data-link=\""+_6d.refTweets[xn].link+"\" data-rel-id=\""+_6d.refTweets[xn].id+"\" data-sname=\""+_6d.refTweets[xn].username+"\" data-user=\""+_6d.refTweets[xn].userScreenName+"\" data-pub=\""+_73+"\" data-content=\""+_6d.refTweets[xn].content+"\"><a href=\"\" data-user-id=\""+_6d.refTweets[xn].userId+"\" data-action=\"populate.twitter\" class=\"thumblink\">"+_74+_6d.refTweets[xn].username+"\"  src=\""+_6d.refTweets[xn].userAvatar+"\"></img></a></li>";_72=_72+_75;}_72=_72+"</ul></div>";_6f=_6f+_72;}return _6f;}else{if(_6d.type&&_6d.type=="BLOG"){_6d=this.feed.normalizeBlogObj(_6d);return dojo.string.substitute(this.feed.templates.blogItem,{data:_6d});}else{if(_6d.type&&_6d.type=="VIDEO"){_6d=this.feed.normalizeYTObj(_6d);var _6f=null;if(_6e=="GRID"){_6f=dojo.string.substitute(this.feed.templates.videoYTItemGrid,{data:_6d});}else{_6f=dojo.string.substitute(this.feed.templates.videoYTItem,{data:_6d});}return _6f;}}}}}catch(e){console.error(e);}return "";},copyRelated:function(_76){var id=dojo.attr(_76,"data-id");var _77=dojo.attr(_76,"data-rank");var _78=dojo.byId(_77+"-"+id+"-relContainer");var _79=dojo.byId(_77+"-"+id+"-relatedTweets");if(_79){dojo.place(_79,_78,"replace");dojo.query(".relatedinitialhide",_76).removeClass("relatedinitialhide");var _7a=dojo.query(".tweetitem .tweetchannel .thumblink",_76)[0];if(_7a&&!dojo.hasClass(_7a,"hideThumblink")){dojo.addClass(_7a,"hideThumblink");}}},populateTwitter:function(_7b){if(_7b){dojo.stopEvent(_7b);}try{var _7c=new dojo.NodeList(_7b.target).closest(".relatedTweetitem")[0];var _7d=dojo.query(".thumblink",_7c)[0];var _7e=dojo.query(".thumb",_7d)[0];var _7f=dojo.attr(_7d,"data-user-id");var _80=dojo.attr(_7c,"data-sname");var _81=dojo.attr(_7c,"data-user");var _82=dojo.attr(_7c,"data-pub");var _83=dojo.attr(_7c,"data-content");var _84=dojo.attr(_7e,"src");var _85=dojo.attr(_7c,"data-link");var _86=dojo.attr(_7c,"data-rel-id");var _87=new dojo.NodeList(_7c).closest(".voicesItem")[0];dojo.attr(_87,"data-id",_86);var _88=dojo.query(".tweetitem",_87)[0];var _89=dojo.query(".namelink",_87)[0];dojo.attr(_89,"data-user-id",_7f);_89.innerHTML=_80;var _8a=dojo.query(".handlelink",_87)[0];dojo.attr(_8a,"data-user-id",_7f);_8a.innerHTML="@"+_81;var _8b=dojo.query(".ibm_cci--txttwt > p",_87)[0];_8b.innerHTML=ibm.v17e.voices.widget.handler.twitterTextProcess(_83);var _8c=dojo.query(".ibm_cci-tts .timelink",_87)[0];dojo.attr(_8c,"href",_85);dojo.attr(_8c,"data-timeval",_82);_8c.innerHTML=ibm.v17e.voices.widget.handler.prettyDateVal(_82);var _8d=dojo.query(".selected",_87);if(_8d){_8d.removeClass("selected");}dojo.addClass(_7e,"selected");if(this.isSearch&&this.searchTerms&&this.searchTerms!=""&&this.searchResCount&&this.searchResCount>0){ibm.v17e.voices.widget.handler.highlightSearchTerms(_88,this.searchTerms);}ibm.v17e.voices.utils.analytics.log("URLRef","Item",_86);}catch(e){console.error("populateTwitter failed: "+dojo.toJson(e));}},noop:{}};}if(!dojo._hasResource["ibm.v17e.voices.widget.controllers.TweetResolvedObj"]){dojo._hasResource["ibm.v17e.voices.widget.controllers.TweetResolvedObj"]=true;dojo.provide("ibm.v17e.voices.widget.controllers.TweetResolvedObj");dojo.declare("ibm.v17e.voices.widget.controllers.TweetResolvedObj",[dijit._Widget,dijit._Templated],{templateString:dojo.cache("ibm.v17e.voices.widget.controllers","templates/urlItem.html","\t\t\t\t\t\t<div class=\"voicesItem ibm-col-1-1\" data-rank=\"${data.rank}\" data-action=\"urlresolved.details\" data-id='${currentTweet.id}' data-published=\"${currentTweet.published}\" data-score='${data.score}'>\r\n\r\n\t\t\t\t\t\t\t<!-- LEFT BLOCK (START) -->\t\r\n\t\t\t\t\t\t\t\t<div class=\"ibm-col-6-4\">\r\n\t\t\t\t\t\t\t\t\t<!-- REA SCORE BLOCK (START) -->\r\n\t\t\t\t\t\t\t\t\t<div class=\"ibm_cci--rea-block\">\r\n\t\t\t\t\t\t\t\t\t\t<ul>\r\n\t\t\t\t\t\t\t\t\t\t\t<li>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<p class=\"ibm_cci--rea-rank\">${!data.position}</p>\r\n\t\t\t\t\t\t\t\t\t\t\t</li>\r\n\t\t\t\t\t\t\t\t\t\t\t<li class=\"ibm_cci__padding-top\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"ibm_cci--rea-b\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"ibm_cci--rea-b-e\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"ibm_cci--rea-b\" style=\"width: ${!data.reachPct}%;\"></div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"ibm_cci--rea-b-e\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"ibm_cci--rea-b\" style=\"width: ${!data.engmtPct}%;\"></div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"ibm_cci--rea-b-e\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"ibm_cci--rea-b\" style=\"width: ${!data.ampPct}%;\"></div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t</li>\r\n\t\t\t\t\t\t\t\t\t\t</ul>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t<!-- REA SCORE BLOCK (END) -->\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t<!-- RESOLVED URL WITH MULTIPLE TWEETS CONTENT BLOCK (START) -->\r\n\t\t\t\t\t\t\t\t\t<div class=\"ibm_cci--rcb\">\r\n\t\t\t\t\t\t\t\t\t\t<div class=\"ibm_cci-fav-ihb\">\r\n\t\t\t\t\t\t\t\t\t\t\t<p class=\"ibm_cci--feed-icon\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<a data-action=\"new-tab\" href=\"${data.link}\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<img width=\"16\" height=\"16\" alt=\"\"  image\" src=\"${data.icon}\" data-properties=\"siteUserAvatar:src\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</a>\r\n\t\t\t\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t\t\t\t\t<a data-action=\"new-tab\" href=\"${data.link}\" class=\"ibm_cci--feed-title\">${data.domain}</a>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t<div class=\"ibm_cci-sib\">\r\n\t\t\t\t\t\t\t\t\t\t\t<ul class=\"ibm_cci-sie\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<li>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<a alt=\"\" href=\"#\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<img width=\"16\" height=\"16\" alt=\"\" data-action=\"twitter.share\" type=\"image/svg+xml\" src=\"images/ibm/voices/v17e/ibm_social_twitter_icon_16x16.svg\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</a>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</li>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<li>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<a alt=\"\" href=\"#\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<img width=\"16\" height=\"16\" alt=\"\" data-action=\"facebook.share\" type=\"image/svg+xml\" src=\"images/ibm/voices/v17e/ibm_social_facebook_icon_16x16.svg\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</a>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</li>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<li>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<a alt=\"\" href=\"#\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<img width=\"16\" height=\"16\" alt=\"\" data-action=\"linkedin.share\" type=\"image/svg+xml\" src=\"images/ibm/voices/v17e/ibm_social_linkedin_icon_16x16.svg\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</a>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</li>\r\n\t\t\t\t\t\t\t\t\t\t\t</ul>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t<div class=\"ibm_cci--ttb\" data-action=\"urlresolved.details\">\r\n\t\t\t\t\t\t\t\t\t\t\t<h2 class=\"ibm_cci--tweet-title\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<a data-action=\"new-tab\" href=\"${data.link}\" class=\"urlhrefval urltitleval\">${data.title}</a>\r\n\t\t\t\t\t\t\t\t\t\t\t</h2>\r\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"ibm_cci--tweet-description\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"ibm_cci--tweet-content-text\">${data.content}</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"ibm_cci-media-container\"></div>\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t<!-- SOCIAL FOR GRID VIEW -->\r\n\t\t\t\t\t\t\t\t\t\t<div class=\"ibm_cci-gv-sib\">\r\n\t\t\t\t\t\t\t\t\t\t\t<ul class=\"ibm_cci-sie\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<li>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<a alt=\"\" href=\"#\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<img alt=\"\" data-action=\"twitter.share\" type=\"image/svg+xml\" src=\"images/ibm/voices/v17e/ibm_social_twitter_icon_16x16.svg\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</a>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</li>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<li>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<a alt=\"\" href=\"#\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<img alt=\"\" data-action=\"facebook.share\" type=\"image/svg+xml\" src=\"images/ibm/voices/v17e/ibm_social_facebook_icon_16x16.svg\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</a>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</li>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<li>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<a alt=\"\" href=\"#\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<img alt=\"\" data-action=\"linkedin.share\" type=\"image/svg+xml\" src=\"images/ibm/voices/v17e/ibm_social_linkedin_icon_16x16.svg\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</a>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</li>\r\n\t\t\t\t\t\t\t\t\t\t\t</ul>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t<!-- SOCIAL FOR GRID VIEW -->\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t<!-- RESOLVED URL WITH MULTIPLE TWEETS CONTENT BLOCK (START) -->\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<!-- LEFT BLOCK (END) -->\r\n\t\t\t\t\t\t\t<!-- RIGHT BLOCK (START)  -->\r\n\t\t\t\t\t\t\t\t<div class=\"ibm-col-6-2  tweetitem\">\r\n\t\t\t\t\t\t\t\t\t<div class=\"ibm_cci-rel-tweet-container\">\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t<!-- TWEET CONVERSATION DIV (BEGIN) -->\r\n\t\t\t\t\t\t\t\t\t<div class=\"ibm_cci-rel-tweet-detils-container\">\r\n\t\t\t\t\t\t\t\t\t\t<div class=\"ibm_cci--lv-rc-th\">\r\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"ibm_cci-img-tweet-container\">\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t<h3 class=\"ibm_cci--lv-rc-title\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<a href=\"javascript:void(0);\" class=\"namelink\" data-user-id=\"${currentTweet.userId}\" data-action=\"twitter.profile\">${currentTweet.userName}</a>\r\n\t\t\t\t\t\t\t\t\t\t\t</h3>\r\n\t\t\t\t\t\t\t\t\t\t\t<p class=\"ibm_cci--lv-rc-h\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<a href=\"javascript:void(0);\" class=\"handlelink\" data-user-id=\"${currentTweet.userId}\" data-action=\"twitter.profile\">@${currentTweet.userScreenName}</a>\r\n\t\t\t\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t<div class=\"ibm_cci--time-stamp\">\r\n\t\t\t\t\t\t\t\t\t\t\t<p class=\"ibm_cci-tts\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<span></span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<img src=\"images/ibm/voices/v17e/ibm_twitter_timestamp_icon_12x12.png\" alt=\"\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<a  class=\"timelink\" alt=\"\" data-action=\"new-tab\" href=\"${currentTweet.link}\" data-timeval=\"${currentTweet.published}\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t${currentTweet.published}\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t\t</a>\r\n\t\t\t\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t\t\t\t</div>\t\t\r\n\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t<div class=\"ibm_cci--lv-rc-description ibm_cci--txttwt\">\r\n\t\t\t\t\t\t\t\t\t\t<p>${currentTweet.content}</p>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t<div class=\"ibm_cci--lv-rc-sharing\">\r\n\t\t\t\t\t\t\t\t\t\t<ul>\r\n\t\t\t\t\t\t\t\t\t\t\t<li>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<a alt=\"\" href=\"javascript:void(0);\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<img alt=\"reply\" data-action=\"twitter.reply\" src=\"images/ibm/voices/v17e/ibm_reply_icon.png\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</a>\r\n\t\t\t\t\t\t\t\t\t\t\t</li>\r\n\t\t\t\t\t\t\t\t\t\t\t<li>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<a alt=\"\" href=\"javascript:void(0);\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<img alt=\"retweet\"  data-action=\"twitter.retweet\" src=\"images/ibm/voices/v17e/ibm_retweet_icon.png\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</a>\r\n\t\t\t\t\t\t\t\t\t\t\t</li>\r\n\t\t\t\t\t\t\t\t\t\t\t<li>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<a alt=\"\" href=\"javascript:void(0);\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<img alt=\"favorite\" data-action=\"twitter.fav\" src=\"images/ibm/voices/v17e/ibm_favorite_icon.png\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</a>\r\n\t\t\t\t\t\t\t\t\t\t\t</li>\r\n\t\t\t\t\t\t\t\t\t\t</ul>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t<!-- TWEET CONVERSATION DIV (END) -->\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<!-- RIGHT BLOCK (END)  -->\r\n\t\t\t\t\t\t\t</div>\r\n"),constructor:function(_8e){if(_8e){this.data=this.normalizeObj(_8e);this.setDefaultTweetValues();}},name:"tweetResolvedObj",data:null,currentTweet:{id:"",userName:"",userScreenName:"",userId:"",link:"",content:"",publishedStr:"",published:0},buildRendering:function(){this.inherited(arguments);},startup:function(){this.inherited(arguments);var _8f=dojo.query(".ibm_cci-rel-tweet-container",this.domNode)[0];if(this.data.refTweets&&this.data.refTweets.length>0){this.addRelatedTweets(_8f);}this.applyTwitterCustomChanges();},correctRank:function(){var _90=dojo.query(".ibm_cci--rea-rank",this.domNode)[0];if(_90.innerHTML.trim().length>2){dojo.addClass(_90,"ibm_cci-reducedFont");}},normalizeObj:function(obj){obj.reachPct=obj.reachPct?obj.reachPct:"0";obj.engmtPct=obj.engmtPct?obj.engmtPct:"0";obj.ampPct=obj.ampPct?obj.ampPct:"0";obj.userId=obj.userId?obj.userId:"";obj.userAvatar=obj.userAvatar?obj.userAvatar:"";obj.username=obj.username?obj.username:"";obj.userScreenName=obj.userScreenName?obj.userScreenName:"";obj.link=obj.link?obj.link:"";obj.title=obj.title?obj.title:"";obj.content=obj.content?(obj.content):"";obj.publishedStr=obj.publishedStr?obj.publishedStr:"";obj.url=obj.url?obj.url:"";obj.urlSite=obj.urlSite?obj.urlSite:"";obj.urlTitle=obj.urlTitle?obj.urlTitle:"";obj.urlIcon=obj.urlIcon?obj.urlIcon:"";obj.domain=obj.domain?ibm.v17e.voices.widget.handler.processDomain(obj.domain):"";obj.source=obj.source?obj.source:"";obj.published=obj.published?obj.published:0;obj.id=obj.id?obj.id:"";obj.score=obj.score?obj.score:0;obj.rank=obj.rank?obj.rank:0;obj.rank_str=obj.rank?(((""+obj.rank).length==1)?"0"+obj.rank:obj.rank+""):"00";obj.position=obj.rank?(((""+obj.rank).length==1)?"0"+obj.rank:obj.rank+""):"00";obj.icon=obj.icon?obj.icon:"";obj.mediaURL=obj.mediaURL?obj.mediaURL:"";obj.layout=obj.layout?obj.layout:ibm.v17e.voices.widget.konst.GRID;obj.refTweets=obj.refTweets?obj.refTweets:null;return obj;},destroy:function(){this.inherited(arguments);},setDefaultTweetValues:function(){if(this.data.refTweets&&this.data.refTweets.length>0){var _91=this.data.refTweets[0];this.currentTweet.id=_91.id?_91.id:"";this.currentTweet.userName=_91.username?_91.username:"";this.currentTweet.userScreenName=_91.userScreenName?_91.userScreenName:"";this.currentTweet.userId=_91.userId?_91.userId:"";this.currentTweet.link=_91.link?_91.link:"";this.currentTweet.content=_91.content?_91.content:"";this.currentTweet.publishedStr=_91.publishedStr?_91.publishedStr:"";this.currentTweet.published=_91.published?_91.published:0;}},applyTwitterCustomChanges:function(){var _92=dojo.query(".ibm_cci--txttwt",this.domNode)[0];ibm.v17e.voices.widget.handler.twitterProcessContent(_92);var _93=dojo.query(".timelink",this.domNode)[0];ibm.v17e.voices.widget.handler.prettyDate(_93);var _94=dojo.query(".ibm_cci--tweet-content-text",this.domNode)[0];var _95=new dojo.NodeList(_94).closest(".voicesItem")[0];var _96=dojo.query(".urlhrefval",_95)[0];var _97="javascript:void(0);";var _98=dojo.query(".ibm_cci--feed-title",_95)[0];_98=_98?_98:"";if(_96){_97=dojo.attr(_96,"href");}if(_94&&_94.innerHTML&&_94.innerHTML.length>170){_94.innerHTML=_94.innerHTML.substring(0,170)+"...<span class=\"ibm_cci--tweet-description-readmore\"><a data-action='new-tab' href='"+_97+"'>&nbsp;Read More</a></span>";}if(this.data.layout==ibm.v17e.voices.widget.konst.GRID||(_98.innerHTML.indexOf("youtube")>-1)){dojo.style(_94,"display","none");}else{dojo.style(_94,"display","");}this.correctRank();},addRelatedTweets:function(_99){if(this.data.refTweets&&this.data.refTweets.length>0){var _9a=10;if(this.data.refTweets.length<10){_9a=this.data.refTweets.length;}var _9b="<div class=\"ibm_cci-related-main-div\" id=\""+this.data.rank+"-"+this.data.refTweets[0].id+"-relatedTweets\"><ul class=\"ibm_cci-relatedTweetContainer\">";for(var xn=0;xn<_9a;xn++){var _9c=this.data.refTweets[xn].published+"";var _9d="<img class=\"thumb\" alt=\"";if(xn==0){_9d="<img class=\"thumb selected\" alt=\"";}this.data.refTweets[xn].content=this.data.refTweets[xn].content.replace(/"/g,"&quot;");var _9e="<li class=\"relatedTweetitem\" data-link=\""+this.data.refTweets[xn].link+"\" data-rel-id=\""+this.data.refTweets[xn].id+"\" data-sname=\""+this.data.refTweets[xn].username+"\" data-user=\""+this.data.refTweets[xn].userScreenName+"\" data-pub=\""+_9c+"\" data-content=\""+this.data.refTweets[xn].content+"\"><a href=\"\" data-user-id=\""+this.data.refTweets[xn].userId+"\" data-action=\"populate.twitter\" class=\"thumblink\">"+_9d+this.data.refTweets[xn].username+"\"  src=\""+this.data.refTweets[xn].userAvatar+"\"></img></a></li>";_9b=_9b+_9e;}_9b=_9b+"</ul></div>";_99.innerHTML=_9b;}},searchingEventFilters:["onclick","onmousedown","onmouseup","onkeydown","onkeyup","onkeypress"],eventHandler:function(evt){var _9f=dojo.attr(evt.target,"data-action");if(!_9f){_9f=dojo.attr(evt.target.parentElement,"data-action");}if(_9f){if(_9f=="twitter.fav"||_9f=="twitter.retweet"||_9f=="twitter.reply"||_9f=="twitter.profile"){ibm.v17e.voices.widget.handler.twitterAction(evt);}if(_9f=="twitter.share"||_9f=="facebook.share"||_9f=="linkedin.share"){ibm.v17e.voices.widget.handler.shareAction(evt);}}}});}if(!dojo._hasResource["ibm.v17e.voices.widget.controllers.TwitterObj"]){dojo._hasResource["ibm.v17e.voices.widget.controllers.TwitterObj"]=true;dojo.provide("ibm.v17e.voices.widget.controllers.TwitterObj");dojo.declare("ibm.v17e.voices.widget.controllers.TwitterObj",[dijit._Widget,dijit._Templated],{templateString:dojo.cache("ibm.v17e.voices.widget.controllers","templates/twitter.html","\t\t\t\t\t\t\t<div class=\"ibm-col-1-1 voicesItem\" data-rank=\"${data.rank}\" data-score='${data.score}' data-id='${!data.id}' data-published=\"${!data.published}\">\r\n\t\t\t\t\t\t\t\t<!-- TWEET BLOCK (START) -->\t\r\n\t\t\t\t\t\t\t\t<div class=\"ibm_cci--lv-unro-b\">\r\n\t\t\t\t\t\t\t\t\t<!-- REA SCORE BLOCK (START) -->\r\n\t\t\t\t\t\t\t\t\t<div class=\"ibm_cci--rea-block\">\r\n\t\t\t\t\t\t\t\t\t\t<ul>\r\n\t\t\t\t\t\t\t\t\t\t\t<li>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<p class=\"ibm_cci--rea-rank\">${!data.position}</p>\r\n\t\t\t\t\t\t\t\t\t\t\t</li>\r\n\t\t\t\t\t\t\t\t\t\t\t<li class=\"ibm_cci__padding-top\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"ibm_cci--rea-b\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"ibm_cci--rea-b-e\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"ibm_cci--rea-b\" style=\"width: ${!data.reachPct}%;\"></div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"ibm_cci--rea-b-e\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"ibm_cci--rea-b\" style=\"width: ${!data.engmtPct}%;\"></div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"ibm_cci--rea-b-e\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"ibm_cci--rea-b\" style=\"width: ${!data.ampPct}%;\"></div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t</li>\r\n\t\t\t\t\t\t\t\t\t\t</ul>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t<!-- REA SCORE BLOCK (END) -->\r\n\t\t\t\t\t\t\t\t\t<!-- UNRESOLVED URL BLOCK (START) -->\r\n\t\t\t\t\t\t\t\t\t<div class=\"ibm_cci--unr-cb\">\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t<div  data-user-id=\"${!data.userId}\" class=\"ibm_cci--lv-rc-th ibm_cci--gv-rc-th\">\r\n\t\t\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<img class=\"ibm_cci--lv-rc-avatar\"  data-user-id=\"${!data.userId}\" src=\"${!data.userAvatar}\" width=\"25\" height=\"25\">\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<h3 class=\"ibm_cci--lv-r-wct\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<a  data-user-id=\"${!data.userId}\" data-action=\"twitter.profile\" href=\"#\" alt=\"\">${!data.username}</a>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</h3>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<p class=\"ibm_cci--lv-r-wch\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<a  data-user-id=\"${!data.userId}\"  data-action=\"twitter.profile\" href=\"#\">${!data.userScreenName}</a>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t<div class=\"ibm_cci--time-stamp\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<p class=\"ibm_cci-tts\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span></span><img alt=\"\" src=\"images/ibm/voices/v17e/ibm_twitter_timestamp_icon_12x12.png\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<a class=\"timelink\" href=\"${!data.link}\"  data-action=\"new-tab\"  data-timeval=\"${!data.published}\">${!data.prettyDateVal}</a>\r\n\t\t\t\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t<div class=\"ibm_cci--ttb\">\r\n\t\t\t\t\t\t\t\t\t\t\t<h2 class=\"ibm_cci--tweet-title\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t${!data.content}\r\n\t\t\t\t\t\t\t\t\t\t\t</h2>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t<div class=\"ibm_cci--lv-rc-sharing\">\r\n\t\t\t\t\t\t\t\t\t\t\t<ul>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<li>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<a href=\"#\" alt=\"\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<img src=\"images/ibm/voices/v17e/ibm_reply_icon.png\" data-action=\"twitter.reply\" alt=\"reply to tweet\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</a>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</li>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<li>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<a href=\"#\" alt=\"\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<img src=\"images/ibm/voices/v17e/ibm_retweet_icon.png\" data-action=\"twitter.retweet\" alt=\"retweet button\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</a>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</li>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<li>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<a href=\"#\" alt=\"\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<img src=\"images/ibm/voices/v17e/ibm_favorite_icon.png\" data-action=\"twitter.fav\" alt=\"favorite button\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</a>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</li>\r\n\t\t\t\t\t\t\t\t\t\t\t</ul>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t<!-- UNRESOLVED URL BLOCK (START) -->\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t<!-- TWEET BLOCK (END) -->\r\n\t\t\t\t\t\t\t</div>\r\n"),constructor:function(_a0){if(_a0){this.data=this.normalizeObj(_a0);}},name:"twitterObj",data:null,buildRendering:function(){this.inherited(arguments);},startup:function(){this.inherited(arguments);dojo.connect(this.domNode,"onclick",this,"eventHandler");this.correctRank();},correctRank:function(){var _a1=dojo.query(".ibm_cci--rea-rank",this.domNode)[0];if(_a1.innerHTML.trim().length>2){dojo.addClass(_a1,"ibm_cci-reducedFont");}},normalizeObj:function(obj){obj.reachPct=obj.reachPct?obj.reachPct:"0";obj.engmtPct=obj.engmtPct?obj.engmtPct:"0";obj.ampPct=obj.ampPct?obj.ampPct:"0";obj.userId=obj.userId?obj.userId:"";obj.userAvatar=obj.userAvatar?obj.userAvatar:"";obj.username=obj.username?obj.username:"";obj.userScreenName=obj.userScreenName?obj.userScreenName:"";obj.link=obj.link?obj.link:"";obj.title=obj.title?obj.title:"";obj.content=ibm.v17e.voices.widget.handler.twitterTextProcess(obj.content);obj.position=obj.rank?(((""+obj.rank).length==1)?"0"+obj.rank:obj.rank+""):"00";return obj;},destroy:function(){this.inherited(arguments);},searchingEventFilters:["onclick","onmousedown","onmouseup","onkeydown","onkeyup","onkeypress"],eventHandler:function(evt){var _a2=dojo.attr(evt.target,"data-action");if(!_a2){_a2=dojo.attr(evt.target.parentElement,"data-action");}if(_a2){if(_a2=="twitter.fav"||_a2=="twitter.retweet"||_a2=="twitter.reply"||_a2=="twitter.profile"){ibm.v17e.voices.widget.handler.twitterAction(evt);}}}});}if(!dojo._hasResource["dojox.fx._core"]){dojo._hasResource["dojox.fx._core"]=true;dojo.provide("dojox.fx._core");dojox.fx._Line=function(_a3,end){this.start=_a3;this.end=end;var _a4=dojo.isArray(_a3),d=(_a4?[]:end-_a3);if(_a4){dojo.forEach(this.start,function(s,i){d[i]=this.end[i]-s;},this);this.getValue=function(n){var res=[];dojo.forEach(this.start,function(s,i){res[i]=(d[i]*n)+s;},this);return res;};}else{this.getValue=function(n){return (d*n)+this.start;};}};}if(!dojo._hasResource["dojox.fx.scroll"]){dojo._hasResource["dojox.fx.scroll"]=true;dojo.provide("dojox.fx.scroll");dojo.experimental("dojox.fx.scroll");dojox.fx.smoothScroll=function(_a5){if(!_a5.target){_a5.target=dojo.position(_a5.node);}var _a6=dojo[(dojo.isIE?"isObject":"isFunction")](_a5["win"].scrollTo),_a7={x:_a5.target.x,y:_a5.target.y};if(!_a6){var _a8=dojo.position(_a5.win);_a7.x-=_a8.x;_a7.y-=_a8.y;}var _a9=(_a6)?(function(val){_a5.win.scrollTo(val[0],val[1]);}):(function(val){_a5.win.scrollLeft=val[0];_a5.win.scrollTop=val[1];});var _aa=new dojo.Animation(dojo.mixin({beforeBegin:function(){if(this.curve){delete this.curve;}var _ab=_a6?dojo._docScroll():{x:_a5.win.scrollLeft,y:_a5.win.scrollTop};_aa.curve=new dojox.fx._Line([_ab.x,_ab.y],[_ab.x+_a7.x,_ab.y+_a7.y]);},onAnimate:_a9},_a5));return _aa;};}if(!dojo._hasResource["ibm.v17e.voices.widget._blockerHandler"]){dojo._hasResource["ibm.v17e.voices.widget._blockerHandler"]=true;dojo.provide("ibm.v17e.voices.widget._blockerHandler");dojo.declare("ibm.v17e.voices.widget._blockerHandler",null,{_uiBlocker:null,_loaderGfx:null,_loaderShown:false,showLoader:function(){if(this._loaderShown){return;}var _ac=this;this.hideLoader();this._loaderShown=true;setTimeout(function(){if(_ac._loaderShown){_ac._uiBlocker=_ac._uiBlocker||dojo.create("div",{"class":"ibm_cci-blocker"});_ac._loaderGfx=dojo.create("div",{"class":"ibm_cci-loade"});_ac.containerNode.appendChild(_ac._uiBlocker);_ac.containerNode.appendChild(_ac._loaderGfx);dojo.animateProperty({node:_ac._uiBlocker,properties:{opacity:{start:0,end:0.75}},duration:500}).play();dojo.animateProperty({node:_ac._loaderGfx,properties:{opacity:{start:0,end:1}},duration:500}).play();setTimeout(function(){_ac._loaderAnimationFrame();},33);}},250);},hideLoader:function(){this._loaderShown=false;if(this._loaderGfx){var _ad=this._loaderGfx;this._loaderGfx=null;dojo.animateProperty({node:_ad,duration:250,properties:{opacity:{end:0}},onEnd:function(){_ad.parentNode.removeChild(_ad);}}).play();dojo.animateProperty({node:this._uiBlocker,duration:250,properties:{opacity:{end:0}},onEnd:function(){var _ae=this.node;_ae.parentNode.removeChild(_ae);}}).play();}},_loaderAnimationFrame:function(){if(this._loaderShown){if(!this._loaderAnimationFrame.angle){this._loaderAnimationFrame.angle=0;}this._loaderAnimationFrame.angle+=45;var rot="rotate("+this._loaderAnimationFrame.angle+"deg)";dojo.style(this._loaderGfx,"-ms-transform",rot);dojo.style(this._loaderGfx,"-moz-transform",rot);dojo.style(this._loaderGfx,"-webkit-transform",rot);dojo.style(this._loaderGfx,"transform",rot);var _af=this;setTimeout(function(){_af._loaderAnimationFrame();},1000/5);}}});}if(!dojo._hasResource["ibm.v17e.voices.widget.gridView"]){dojo._hasResource["ibm.v17e.voices.widget.gridView"]=true;dojo.provide("ibm.v17e.voices.widget.gridView");dojo.declare("ibm.v17e.voices.widget.gridView",[dijit._Widget,dijit._Templated,ibm.v17e.voices.widget._blockerHandler],{id:"ibm_cci-widget-js",feedType:"",configId:"",config:null,srcNodeRef:null,_gridWidth:300,_gutterWidth:20,_columns:0,_choosenPosition:null,_currentPositions:{"position":[{"leftPos":0,"topPos":0,"height":0},{"leftPos":320,"topPos":0,"height":0},{"leftPos":640,"topPos":0,"height":0}]},currentItemCount:0,viewPortWidth:0,mediaURLCount:0,_resizeRequired:true,layout:ibm.v17e.voices.widget.konst.GRID,_connects:[],_subscriptions:[],listHeight:0,focusItem:null,resizeTimer:null,resizeDelay:500,topLink:null,_scrollHandle:null,lockScroll:true,moreDataAvailable:false,loadingTemplate:"<span class=\"ibm-spinner-small\" />",gridLoadingTemplate:"<div class=\"ibm-card-data ibm-voices-grid-load-spinner\"><span class=\"ibm-spinner-small\" /></div>",isSearch:false,searchTerms:null,searchResCount:0,constructor:function(_b0){},subscriptions:{"/feed/procResp":"procResp","/voices/search":"onSearch","/feed/done/images":"postImageLoad","/voices/trigger/search":"contentLoadingStart","/voices/tt/clicked":"contentLoadingStart"},buildRendering:function(){this.domNode=this.srcNodeRef;this.srcNodeRef=null;},startup:function(){this.inherited(arguments);try{this.containerNode=this.domNode;this.setGridDefaults();for(var _b1 in this.subscriptions){this._subscriptions.push(dojo.subscribe(this.config.topicPrefix+_b1,this,this.subscriptions[_b1]));}this.loadData();var _b2=dojo.global.window.document.getElementById("ibm_cci--toggle-js");dojo.connect(_b2,"onclick",this,this.changeView);this._connects.push(dojo.connect(window,"onscroll",this,dojo.hitch(this,"handleScroll")));this._scrollHandle=this._connects.length-1;this._connects.push(dojo.connect(dojo.global,"resize",this,this.resizeHandler));this._connects.push(this.connect(this.domNode,"onclick","eventHandler"));var _b3=dojo.query("#ibm_cci-gototop")[0];this._connects.push(dojo.connect(_b3,"onclick",this,function(){dojox.fx.smoothScroll({node:dojo.byId("ibm-com"),win:window,duration:300}).play();}));this.topLink=dojo.byId("ibm_cci-gototop");dojo.style(this.topLink,{opacity:0,visibility:"visible"});}catch(e){console.error("Inside startup "+e);}},loadData:function(){try{this.showLoader();this.isSearch=false;this.searchTerms=null;this.searchResCount=0;dojo.publish("/voices/search",[""]);}catch(e){console.error("Inside loadData "+e);}},contentLoadingStart:function(evt){try{this.showLoader();}catch(e){console.error("Content Loading Start error: "+e);}},resizeHandler:function(){var _b4=dojo.window.getBox();if((_b4.w>800&&this._columns!=3)||(_b4.w>568&&_b4.w<801&&this._columns!=2)||(_b4.w<569&&this._columns!=1)){if(this.resizeTimer){clearTimeout(this.resizeTimer);}this._resizeRequired=true;this.resizeTimer=setTimeout(dojo.hitch(this,this.resize),this.resizeDelay);}},resize:function(){try{var _b5=dojo.window.getBox();if(_b5.w<569&&this.layout!=ibm.v17e.voices.widget.konst.GRID){this.layout=ibm.v17e.voices.widget.konst.GRID;var _b6=dojo.query(".ibm_cci--ls--toggle--li--grid-icon a[data-action=GRID.VIEW]",dojo.global.window.document)[0];var _b7={target:_b6};ibm.v17e.voices.widget.handler.toggleViewSelection(_b7);this.switchViewTo("GRID.VIEW");return;}var _b8=this;var _b9=dojo.query(".ibm_cci--newly-added",this.containerNode);if(this.layout==ibm.v17e.voices.widget.konst.GRID){if(!(_b9)||(_b9&&_b9.length==0)){_b9=dojo.query(".voicesItem",this.containerNode);this.setGridDefaults();}if(this._resizeRequired){dojo.forEach(_b9,function(ele){_b8.addGRIDElement(ele);if(dojo.hasClass(ele,"ibm_cci--newly-added")){dojo.removeClass(ele,"ibm_cci--newly-added");}});}}else{if(!(_b9)||(_b9&&_b9.length==0)){_b9=dojo.query(".voicesItem",this.containerNode);}if(this._resizeRequired){this.listHeight=0;var _ba=0;dojo.forEach(_b9,function(ele){_b8.addLISTElement(ele);if(dojo.hasClass(ele,"ibm_cci--newly-added")){dojo.removeClass(ele,"ibm_cci--newly-added");}_ba+=dojo.coords(ele).h;dojo.style(_b8.containerNode,"height",""+_ba+"px");});}}if(this.mediaURLCount==0){var _bb=dojo.query(".ibm_cci-voicesLoader",this.containerNode);if(_bb){_bb.forEach(function(_bc){dojo.destroy(_bc);});}if(this._loaderShown){this.hideLoader();}}}catch(e){console.error("Inside resize "+e);}},searchingEventFilters:["onclick","onmousedown","onmouseup","onkeydown","onkeyup","onkeypress"],eventHandler:function(evt){var _bd="on"+evt.type;if(dojo.hasClass(this.domNode,"smaSearching")&&(dojo.indexOf(_bd,this.searchingEventFilters)<0)){if(evt){dojo.stopEvent(evt);}return;}var _be=dojo.attr(evt.target,"data-action");if(!_be){_be=dojo.attr(evt.target.parentElement,"data-action");}if(_be){if(_be=="populate.twitter"){ibm.v17e.voices.widget.handler.populateTwitter.call(this,evt);}if(_be=="twitter.fav"||_be=="twitter.retweet"||_be=="twitter.reply"||_be=="twitter.profile"){ibm.v17e.voices.widget.handler.twitterAction.call(this,evt);}if(_be=="twitter.share"||_be=="facebook.share"||_be=="linkedin.share"){ibm.v17e.voices.widget.handler.shareAction.call(this,evt);}if(_be=="new-tab"){ibm.v17e.voices.widget.handler.openNewTab.call(this,evt);}if(_be=="youtube.channel"||_be=="youtube.video"){ibm.v17e.voices.widget.handler.youtubeAction.call(this,evt);}if(_be=="youtube.play"){ibm.v17e.voices.widget.handler.youtubePlay.call(this,evt);}if(_be=="visit"){ibm.v17e.voices.widget.handler.visit.call(this,evt);}if(_be=="flag"){ibm.v17e.voices.widget.handler.flag.call(this,evt);}if(_be=="rss"){ibm.v17e.voices.widget.handler.rss.call(this,evt);}}},changeView:function(evt){try{var _bf=dojo.attr(evt.target,"data-action");if(_bf&&(_bf.indexOf(this.layout)<0)&&(_bf.indexOf(".VIEW")>-1)){ibm.v17e.voices.widget.handler.toggleViewSelection(evt);dojo.query(".voicesItem",this.containerNode).forEach(function(ele){var _c0=dojo.attr(ele,"id");dijit.byId(_c0).destroyRecursive();});if(this.isSearch&&this.searchTerms){dojo.publish("/voices/search",[this.searchTerms]);}else{this.loadData();}this.switchViewTo(_bf);}}catch(e){console.error("Inside startup "+e);}},switchViewTo:function(_c1){try{if(_c1=="LIST.VIEW"){this.layout=ibm.v17e.voices.widget.konst.LIST;this.addLISTContainerClass();}else{if(_c1=="GRID.VIEW"){this.layout=ibm.v17e.voices.widget.konst.GRID;this.addGRIDContainerClass();}}this._resizeRequired=true;var _c2=this;dojo.global.window.setTimeout(function(){_c2.resize();_c2.lockScroll=false;var _c3=dojo.query(".voicesItem",_c2.domNode).forEach(function(ele){dojo.style(ele,"visibility","");});},500);}catch(e){console.error("Inside switchViewTo "+e);}},showError:function(){console.error("Error while loading the data ");},onSearch:function(msg){try{dojo.addClass(this.domNode,"smaSearching");this.isSearch=true;this.lockScroll=true;this.showLoader();dojo.query(".voicesItem",this.containerNode).forEach(function(ele){var _c4=dojo.attr(ele,"id");dijit.byId(_c4).destroyRecursive();});if(this.layout==ibm.v17e.voices.widget.konst.GRID){this.setGridDefaults();}var _c5=dojo.query(".ibm_cci-voicesLoader",this.containerNode);if(!_c5||(_c5&&_c5.length==0)){var _c6=dojo.create("div",{innerHTML:"<div class=\"ibm-voices-search-result-count\"></div>"+this.loadingTemplate});dojo.addClass(_c6,"ibm_cci-voicesLoader");dojo.place(_c6,this.containerNode,"last");}dojo.style(this.containerNode,"height","100%");this.itemsCount=0;}catch(e){console.error("onSearch - "+e);}},procResp:function(msg){if(!msg||!msg.action){return;}try{if(msg.action=="load"||msg.action=="update"||msg.action=="search"||msg.action=="loadMore"){if(msg){var _c7=dojo.query("#ibm_cci-search-result-count > p",dojo.global.window.document)[0];if(msg.action=="search"&&msg.searchResponse.terms&&msg.searchResponse.terms.length>0){this.searchTerms=msg.searchResponse.terms?msg.searchResponse.terms:null;this.searchResCount=msg.searchResponse.totalCount;if(this.searchTerms){this.searchTerms=this.searchTerms.toLowerCase().replace(/\s+/g," ");_c7.innerHTML="Results found: "+msg.searchResponse.totalCount+"";dojo.style(_c7,"visibility","visible");}else{dojo.style(_c7,"visibility","hidden");_c7.innerHTML="";this.isSearch=false;this.searchTerms=null;this.searchResCount=0;}}else{if((msg.action=="search"&&!msg.searchResponse.terms)||(msg.action=="loadMore"&&(!this.searchTerms||this.searchTerms==""))){dojo.style(_c7,"visibility","hidden");_c7.innerHTML="";this.searchTerms=null;this.searchResCount=0;this.isSearch=false;}}this.onDataCallBack1(msg);if(msg.searchResponse.entries.length==20){this.moreDataAvailable=true;if(this.mediaURLCount==0){this.lockScroll=false;if(!this._scrollHandle){this._connects.push(dojo.connect(window,"onscroll",this,dojo.hitch(this,"handleScroll")));this._scrollHandle=this._connects.length-1;}this.resize();}}else{this.moreDataAvailable=false;if(this.mediaURLCount==0){this.resize();}}}dojo.removeClass(this.domNode,"smaSearching");}}catch(e){console.error("Failed to process response, err : "+e+" data="+dojo.toJson(msg));}},addGRIDContainerClass:function(){try{dojo.removeClass(this.domNode,"ibm_cci-lv__modifier");dojo.addClass(this.domNode,"ibm_cci-gv__modifier");var _c8=dojo.query(".ibm_cci--tweet-content-text",this.domNode);if(_c8&&_c8.length>0){dojo.forEach(_c8,function(ele){dojo.style(ele,"display","none");});}}catch(e){console.error("Error in addGRIDContainerClass : "+e);}},setGridDefaults:function(){var _c9=dojo.window.getBox();this.viewPortWidth=_c9.w;var _ca=this._columns;if(this.viewPortWidth<569){this._gridWidth=300;this._gutterWidth=0;this._columns=1;this._currentPositions={"position":[{"leftPos":0,"topPos":0,"height":0}]};}else{if((801>this.viewPortWidth)&&(this.viewPortWidth>568)){this._gridWidth=300;this._gutterWidth=20;this._columns=2;this._currentPositions={"position":[{"leftPos":0,"topPos":0,"height":0},{"leftPos":this._gridWidth+this._gutterWidth,"topPos":0,"height":0}]};}else{this._gridWidth=300;this._gutterWidth=20;this._columns=3;this._currentPositions={"position":[{"leftPos":0,"topPos":0,"height":0},{"leftPos":this._gridWidth+this._gutterWidth,"topPos":0,"height":0},{"leftPos":2*(this._gridWidth+this._gutterWidth),"topPos":0,"height":0}]};}}if(!this._choosenPosition){this._choosenPosition=this._currentPositions.position[0];}if((_ca!=this._columns||this.mediaURLCount==0)){this._resizeRequired=true;}else{this._resizeRequired=false;}},calculateLowestPosition:function(){var _cb=this;if(this._currentPositions){dojo.forEach(this._currentPositions.position,function(ele){if((_cb._choosenPosition.topPos+_cb._choosenPosition.height)>(ele.topPos+ele.height)){_cb._choosenPosition=ele;}});}},getHighestLength:function(){var _cc=null;if(this._currentPositions){_cc=this._currentPositions.position[0];dojo.forEach(this._currentPositions.position,function(ele){if((_cc.topPos+_cc.height)<(ele.topPos+ele.height)){_cc=ele;}});}return _cc;},updateCurrentPosition:function(){for(var i=0;i<this._currentPositions.position.length;i++){var ele=this._currentPositions.position[i];if(ele.leftPos==this._choosenPosition.leftPos){this._currentPositions.position[i]=this._choosenPosition;break;}}},addGRIDElement:function(ele){try{var _cd=dojo.coords(ele);this.calculateLowestPosition();this._choosenPosition.height=_cd.h;this.updateCurrentPosition();dojo.style(ele,"display","block");dojo.style(ele,"width",this._gridWidth+"px");dojo.style(ele,"left",""+this._choosenPosition.leftPos+"px");dojo.style(ele,"position","absolute");this.updateMainContainerGRID();var _ce=this._choosenPosition.topPos;var _cf=_ce+500;dojo.style(ele,"top",""+_cf+"px");dojo.animateProperty({node:ele,properties:{opacity:{end:1,start:0},top:{end:_ce,start:_cf}},duration:100,delay:500}).play();this._choosenPosition.topPos=this._choosenPosition.height+this._choosenPosition.topPos;ibm.v17e.voices.widget.handler.processFaviconImages(ele);}catch(e){console.error("Error in Add GRID Element method : "+e);}},updateMainContainerGRID:function(){var _d0=this.getHighestLength();var cH=_d0.topPos;if(this._columns==1){cH=_d0.topPos+_d0.height;}cH=(cH>(this._choosenPosition.topPos+this._choosenPosition.height))?cH:(this._choosenPosition.topPos+this._choosenPosition.height);dojo.style(this.containerNode,"height",""+cH+"px");},setMediaImage:function(url,_d1){try{this.mediaURLCount+=1;var _d2=new Image();var _d3=this;var _d4=dojo.connect(_d2,"load",function(evt){var _d5=_d3._gridWidth-30;if(_d1){if(evt&&evt.target&&evt.target.width>199){dojo.place("<img  width=\""+_d5+"\" class=\"ibm_cci--tweet-image\" alt=\"\" src=\""+url+"\">",_d1,"last");}else{if(evt&&evt.target&&evt.target.height>100){dojo.place("<img  class=\"ibm_cci--tweet-image\" alt=\"\" src=\""+url+"\">",_d1,"last");}else{dojo.style(_d1,"display","none");}}}dojo.publish("/feed/done/images",[_d1]);dojo.disconnect(_d4);});var _d6=dojo.connect(_d2,"error",function(evt){dojo.style(_d1,"display","none");dojo.publish("/feed/done/images",[_d1]);dojo.disconnect(_d6);});_d2.src=url;setTimeout(function(_d7,_d8,_d9){if(_d8&&_d9){dojo.style(_d1,"display","none");dojo.publish("/feed/done/images",[_d1]);}if(_d8){dojo.disconnect(_d8);}if(_d9){dojo.disconnect(_d9);}},1000);}catch(e){console.error("Inside setMediaImage "+e);}},postImageLoad:function(_da){try{this.mediaURLCount-=1;if(this.mediaURLCount==0){this.resize();if(this.moreDataAvailable&&this.lockScroll){this.lockScroll=false;}}}catch(e){console.error("Inside postImageLoad "+e);}},setYoutubePlayer:function(url,_db){url=url.substring(url.indexOf("//"));var _dc="<div class=\"ibm-media\"><div class=\"ibm-video\"><div class=\"ibm-container-body\" dojoattachpoint=\"bodyNode\">"+"<div class=\"ibm-video-container\" dojoattachpoint=\"containerNode\"><object class=\"player\" style=\"height: 293px; width: 270px\">"+"<param name=\"movie\" value=\"${urlContent}\"><param name=\"allowFullScreen\" value=\"true\">"+"<param name=\"allowScriptAccess\" value=\"always\"><embed data-action=\"youtube.play\" width=\"270\" height=\"293\" src=\"${urlContent}\" type=\"application/x-shockwave-flash\" allowfullscreen=\"true\" allowscriptaccess=\"always\" alt=\"&nbsp;\">"+"</object></div></div></div></div>";_dc=dojo.string.substitute(_dc,{urlContent:url});_db.innerHTML=_dc;},addLISTElement:function(ele){try{dojo.removeAttr(ele,"style");dojo.style(ele,"display","");dojo.style(ele,"width","");dojo.style(ele,"left","");dojo.style(ele,"position","");dojo.style(ele,"opacity",1);ibm.v17e.voices.widget.handler.processFaviconImages(ele);}catch(e){console.error("Error in Add List Element method : "+e);}},addLISTContainerClass:function(){try{dojo.removeClass(this.domNode,"ibm_cci-gv__modifier");dojo.addClass(this.domNode,"ibm_cci-lv__modifier");var _dd=dojo.query(".ibm_cci--tweet-content-text",this.domNode);if(_dd&&_dd.length>0){dojo.forEach(_dd,function(ele){dojo.style(ele,"display","inline");});}}catch(e){console.error("Error in addLISTContainerClass : "+e);}},onDataCallBack1:function(_de){try{if(_de.searchResponse.entries){for(var i=0;i<_de.searchResponse.entries.length;i++){var _df=_de.searchResponse.entries[i];var _e0=dijit.byId(_df.id);if(!_e0){_df.prettyDateVal=ibm.v17e.voices.widget.handler.prettyDateVal(_df.published);_df.layout=this.layout;var ele=null;try{if(_df.type&&_df.type=="TWEET"){var _e1=new ibm.v17e.voices.widget.controllers.TwitterObj(_df);_e1.startup();ele=_e1.domNode;}else{if(_df.type&&_df.type=="URLREF"){var _e2=new ibm.v17e.voices.widget.controllers.TweetResolvedObj(_df);_e2.startup();if(this.layout==ibm.v17e.voices.widget.konst.GRID){if(_df.domain&&_df.domain.indexOf("youtube")>-1){this.setYoutubePlayer(_df.content,dojo.query(".ibm_cci-media-container",_e2.domNode)[0]);}else{if(_df.mediaURL&&_df.mediaURL!=""){this.setMediaImage(_df.mediaURL,dojo.query(".ibm_cci-media-container",_e2.domNode)[0]);}else{var _e3=dojo.query(".ibm_cci-media-container",_e2.domNode)[0];dojo.style(_e3,"display","none");}}}ele=_e2.domNode;}}}catch(e){console.error("Error in onDataCallBack method : "+e);}if(this.isSearch&&_de.searchResponse.terms&&_de.searchResponse.terms.length>0){ibm.v17e.voices.widget.handler.highlightSearchTerms(ele,this.searchTerms);}}if(ele){dojo.addClass(ele,"ibm_cci--newly-added");dojo.style(ele,"opacity",0);dojo.place(ele,this.containerNode,"last");}}}}catch(e){console.error("Inside onDataCallBack1 while placing the object "+e);}},handleScroll:function(_e4){try{var _e5=this;var _e6=dojo._docScroll().y;var max=this.calculateMaxHeight();var _e7=this.getScrollOffsets(window);if(max<_e7.y&&!this.lockScroll&&!this._loaderShown){this.lockScroll=true;if(this._scrollHandle){dojo.disconnect(this._connects[this._scrollHandle]);this._scrollHandle=null;}max=this.calculateMaxHeight();var _e8=dojo.query(".voicesItem",this.containerNode);var _e9=_e8[_e8.length-1];if(dojo.query(".ibm_cci-voicesLoader",this.containerNode).length==0){if(this.layout==ibm.v17e.voices.widget.konst.GRID){for(x1=0;x1<this._currentPositions.position.length;x1++){var _ea=this._currentPositions.position[x1];var _eb=dojo.create("div",{innerHTML:this.loadingTemplate});dojo.addClass(_eb,"ibm_cci-voicesLoader");dojo.place(_eb,this.containerNode,"last");var _ec=_ea.topPos;dojo.style(_eb,"left",_ea.leftPos+"px");dojo.style(_eb,"top",_ec+"px");dojo.style(_eb,"position","absolute");dojo.style(_eb,"height","50px");var _ed=this._gridWidth+this._gutterWidth;dojo.style(_eb,"width",""+_ed+"px");}}else{var _eb=dojo.create("div",{innerHTML:this.loadingTemplate});dojo.addClass(_eb,"ibm_cci-voicesLoader");dojo.place(_eb,this.containerNode,"last");}}var _ee=dojo.coords(this.containerNode).h;var _ef=_ee+50;dojo.style(this.containerNode,"height",""+_ef+"px");var _e8=dojo.query(".voicesItem",this.containerNode);var _e9=_e8[_e8.length-1];var msg={published:parseInt(""+dojo.attr(_e9,"data-published")),score:parseFloat(""+dojo.attr(_e9,"data-score"))};dojo.publish("/voices/more",[msg]);ibm.v17e.voices.utils.analytics.log("Load","More","More");}var _f0=-dojo.position(dojo.body()).y,_f1=500;if(_f0>_f1){dojo.fadeIn({node:this.topLink,duration:100}).play();}else{dojo.fadeOut({node:this.topLink,duration:100}).play();}}catch(e){console.error("Error in processing HandlScroll : error"+e);}},getScrollOffsets:function(w){w=w||window;if(w.pageXOffset!=null){return {x:w.pageXOffset,y:w.pageYOffset};}var d=w.document;if(document.compatMode=="CSS1Compat"){return {x:d.documentElement.scrollLeft,y:d.documentElement.scrollTop};}return {x:d.body.scrollLeft,y:d.body.scrollTop};},calculateMaxHeight:function(){return (document.documentElement.scrollHeight-document.documentElement.clientHeight)-900;},destroy:function(){this.inherited(arguments);}});}if(!dojo._hasResource["ibm.v17e.voices.widget.trendingTopics"]){dojo._hasResource["ibm.v17e.voices.widget.trendingTopics"]=true;dojo.provide("ibm.v17e.voices.widget.trendingTopics");dojo.declare("ibm.v17e.voices.widget.trendingTopics",[dijit._Widget,dijit._Templated],{templateString:dojo.cache("ibm.v17e.voices.widget","templates/trendingTopics.html","\t<ul class=\"ibm_cci__ml ibm-voices-custom-tt-container\">\r\n\t\t<li class=\"ibm_cci__ml_t\">\r\n\t\t\t<p class=\"ibm_cci-clicked\">\r\n\t\t\t\t<span>\r\n\t\t\t\t\t<a href=\"javascript:void(0);\" data-click-item=\"all-reset\" class=\"ibm_cci-voices-tt-text\">All trending topics</a>\r\n\t\t\t\t</span>\t\t\t\t\r\n\t\t\t\t<input id=\"chk-box-voices-all\" type=\"checkbox\" name=\"tt\" value=\"all\" style=\"display:none;\"/>\r\n\t\t\t</p>\r\n\t\t</li>\r\n\t</ul>\r\n"),topicTemplate:"<li id=\"${topic}-tt-item\" class=\"ibm_cci__ml-li\" data-click-item=\"${topic}-toggleFilter\">"+"<p>"+"<span><a href=\"javascript:void(0);\" class=\"ibm_cci-voices-tt-text\">${topic}</a></span>"+"<a class=\"ibm_cci-voices-tt-close-container\" href=\"#\"></a>"+"<input id=\"chk-box-voices-${topic}\" type=\"checkbox\" name=\"tt\" value=\"${topic}\" style=\"display:none;\"/>"+"</p>"+"</li>",searchItemTemplate:"<li id=\"${topic}-search-item\" class=\"ibm_cci__ml-li\" data-click-item=\"${topic}-removeSearchFilter\">"+"<p>"+"<span><a href=\"javascript:void(0);\" class=\"ibm_cci-voices-tt-text ibm_cci-voices-search-term\">${topic}</a></span>"+"<a class=\"ibm_cci-voices-tt-close-container\" href=\"#\"></a>"+"<input id=\"chk-box-voices-${topic}\" type=\"checkbox\" checked name=\"tt\" value=\"${topic}\" style=\"display:none;\"/>"+"</p>"+"</li>",id:"ibm-voices-trending",trendingTopics:[],searchList:[],trendingTopicString:"",domNode:null,maxTrendingTopics:0,viewType:"LIST",filterString:"",_connects:[],_subscriptions:[],constructor:function(){for(var _f2 in this.subscriptions){this._subscriptions.push(dojo.subscribe(_f2,this,this.subscriptions[_f2]));}},buildRendering:function(){this.domNode=this.srcNodeRef;this.srcNodeRef=null;this.domNode.innerHTML=dojo.string.substitute(this.templateString,{});},startup:function(){this.inherited(arguments);if(!this.maxTrendingTopics||isNaN(this.maxTrendingTopics)||this.maxTrendingTopics==0){this.maxTrendingTopics=20;}if(!this.trendingTopicString||this.trendingTopicString==""){var _f3={"method":"trending","type":"","target":""};dojo.publish("/voices/rpc",[_f3]);}else{if(this.trendingTopicString.indexOf(",")>-1){this.trendingTopics=this.trendingTopicString.split(",");}if(!this.trendingTopics){this.trendingTopics=[];}this.initilizeTopics();}this._connects.push(dojo.connect(this.domNode,"onclick",this,dojo.hitch(this,"onFilter")));},initilizeTopics:function(){var _f4=this;var _f5=this.trendingTopics.length>this.maxTrendingTopics?this.maxTrendingTopics:this.trendingTopics.length;for(var x=0;x<_f5;x++){var ele=this.trendingTopics[x];var _f6=dojo.string.substitute(this.topicTemplate,{topic:ele});var _f7=dojo.query(".ibm-voices-custom-tt-container",this.domNode)[0];dojo.place(_f6,_f7,"last");}},subscriptions:{"/voices/trigger/search":"onSearch","/feed/procResp":"procResp"},procResp:function(msg){if(!msg||!msg.action){return;}try{if(msg.action=="rpc"){if(msg.searchResponse.trending){this.trendingTopicString=msg.searchResponse.trending;if(this.trendingTopicString.indexOf(",")>-1){this.trendingTopics=this.trendingTopicString.split(",");}}if(!this.trendingTopics){this.trendingTopics=[];}this.initilizeTopics();}}catch(e){console.error("Error in procResp Trending topics : "+e);}},onSearch:function(msg){if(msg.indexOf(",")>-1){this.searchList=msg.split(",");}else{if(msg!=""){this.searchList[0]=msg;}}if(this.searchList.length>0){for(var x=0;x<this.searchList.length;x++){var _f8=false;var _f9="\\b"+ibm.v17e.voices.widget.handler.trimString(this.searchList[x])+"\\b";var _fa=new RegExp(_f9,"gi");var _fb="";var _fc="";var _fd=null;if(!_fa.test(this.filterString)){for(var y=0;y<this.trendingTopics.length;y++){var _fe=ibm.v17e.voices.widget.handler.trimString(this.trendingTopics[y]);if(_fa.test(_fe)){_f8=true;_fb=_fe;break;}}var _ff=ibm.v17e.voices.widget.handler.trimString(this.searchList[x]);if(!_f8&&_ff!=""){var _100=dojo.query(".ibm-voices-custom-tt-container",this.domNode)[0];var html=dojo.string.substitute(this.searchItemTemplate,{topic:_ff});dojo.place(html,_100,"last");var _101=dojo.query(".ibm_cci__ml-li",this.domNode);var _102=_101[_101.length-1];var _103=dojo.query(">p",_102)[0];dojo.addClass(_103,"ibm_cci-clicked");var _104=dojo.query(".ibm_cci-voices-tt-close-container",_102)[0];dojo.addClass(_104,"ibm_cci-close");this.setFilterString();this.higlightAllTrendingTopics();}else{if(_f8){_fc=""+_fb+"-toggleFilter";_fd=dojo.query("li[data-click-item="+_fc+"]",this.domNode)[0];this.filterModification(_fc,_fd);}}}}}dojo.publish("/voices/search",[this.filterString]);this.searchList=[];},onFilter:function(evt){if(evt){dojo.stopEvent(evt);}try{var _105=evt.target;var _106=dojo.attr(evt.target,"data-click-item");if(!_106){var _107=new dojo.NodeList(evt.target).closest(".ibm_cci__ml-li")[0];_106=dojo.attr(_107,"data-click-item");_105=_107;}if(_106){this.filterModification(_106,_105);dojo.publish("/voices/search",[this.filterString]);}}catch(e){console.error("Search error for filter: "+dojo.toJson(e));}},filterModification:function(_108,_109){try{var _10a=_108.split("-");var _10b=dojo.byId("chk-box-voices-"+_10a[0]);if(_108.indexOf("-toggleFilter")>-1){if(_10b.checked){this.dehighlightTT(_10b,_109);}else{this.highlightTT(_10b,_109);}}else{if(_108.indexOf("-removeSearchFilter")>-1){this.removeSearchTerm(_10a[0]);}else{if(_108.indexOf("-reset")>-1){this.resetAllFilters();}}}this.setFilterString();this.higlightAllTrendingTopics();}catch(e){console.error("filterModification error: "+dojo.toJson(e));}},highlightTT:function(_10c,_10d){try{_10c.checked=true;var _10e=_10d;_10d=dojo.query(">p",_10e)[0];if(!dojo.hasClass(_10d,"ibm_cci-clicked")){dojo.addClass(_10d,"ibm_cci-clicked");var _10f=dojo.query(".ibm_cci-voices-tt-close-container",_10e)[0];if(_10f&&!dojo.hasClass(_10f,"ibm_cci-close")){dojo.addClass(_10f,"ibm_cci-close");}}}catch(e){console.error("Error either checking the checkbox or adding selected class to the element: "+_10d+","+dojo.toJson(e));}},dehighlightTT:function(_110,_111){try{_110.checked=false;var _112=_111;_111=dojo.query(">p",_112)[0];if(dojo.hasClass(_111,"ibm_cci-clicked")){dojo.removeClass(_111,"ibm_cci-clicked");var _113=dojo.query(".ibm_cci-voices-tt-close-container",_112)[0];if(_113&&dojo.hasClass(_113,"ibm_cci-close")){dojo.removeClass(_113,"ibm_cci-close");}}}catch(e){console.error("Error either unchecking the checkbox or removing selected class to the element: "+_111+","+dojo.toJson(e));}},removeSearchTerm:function(_114){dojo.destroy(""+_114+"-search-item");},setFilterString:function(){try{var _115=dojo.query("input[name=tt]:checked",this.domNode);this.filterString="";for(var i=0;i<_115.length;i++){this.filterString+=_115[i].value;if(i<_115.length-1){this.filterString+=",";}}}catch(e){console.error("Somethings wrong when Setting filter string ,"+dojo.toJson(e));}},resetAllFilters:function(){try{var _116=dojo.query("input[name=tt]:checked",this.domNode);for(var i=0;i<_116.length;i++){var _117=new dojo.NodeList(_116[i]).closest(".ibm_cci__ml-li")[0];var _118=dojo.attr(_117,"id");if(_118.indexOf("-tt-item")>-1){action=""+_116[i].value+"-toggleFilter";}else{if(_118.indexOf("-search-item")>-1){action=""+_116[i].value+"-removeSearchFilter";}}this.filterModification(action,_117);}}catch(e){console.error("Somethings wrong when Reseting All filters"+dojo.toJson(e));}},higlightAllTrendingTopics:function(){try{var _119=dojo.query(".ibm_cci__ml_t",this.domNode)[0];var _11a=dojo.query(">p",_119)[0];if(this.filterString==""&&!dojo.hasClass(_11a,"ibm_cci-clicked")){dojo.addClass(_11a,"ibm_cci-clicked");}else{if(this.filterString!=""&&dojo.hasClass(_11a,"ibm_cci-clicked")){dojo.removeClass(_11a,"ibm_cci-clicked");}}}catch(e){console.error("Somethings wrong when Highlighting All Trending topic filters"+dojo.toJson(e));}},destroy:function(){try{dojo.forEach(this._subscriptions,dojo.unsubscribe);dojo.forEach(this._connects,dojo.disconnect);dojo.destroy(this.id);}catch(e){console.error("Error while destroying : "+e);}}});}if(!dojo._hasResource["ibm.v17e.voices.widget.vSearchForm"]){dojo._hasResource["ibm.v17e.voices.widget.vSearchForm"]=true;dojo.provide("ibm.v17e.voices.widget.vSearchForm");dojo.declare("ibm.v17e.voices.widget.vSearchForm",[dijit._Widget],{templateString:dojo.cache("ibm.v17e.voices.widget","templates/searchFormTemplate.html","\t<form action=\"#\">\r\n\t\t<!-- <label for=\"ibm-custom-search-field\" class=\"ibm-custom-hide-label\" tabindex=\"1\">Search</label> -->\r\n\t\t<input type=\"text\" name=\"ibm-cc-search--field\" id=\"ibm-cc-search--field\" class=\"ibm-cc-search--field\" dojoAttachPoint=\"searchBox\" />\r\n\t\t<input type=\"image\" src='images/ibm/voices/v17e/ibm_search_icon.png' class=\"ibm-cc-search--icon\" name=\"search button\" value=\"search\" dojoAttachPoint=\"searchButton\" dojoAttachEvent=\"onclick:onSearch\"/>\r\n\t</form>\r\n\r\n\r\n\r\n"),widgetsInTemplate:true,filter:"",searchBox:null,buildRendering:function(){this.inherited(arguments);this.domNode.innerHTML=this.templateString;},startup:function(){this.inherited(arguments);var _11b=dojo.query(".ibm-cc-search--icon",this.domNode)[0];dojo.connect(_11b,"onclick",this,dojo.hitch(this,"onSearch"));},postCreate:function(){this.searchSub=dojo.subscribe("/voices/search",dojo.hitch(this,"displaySearch"));if(!this.searchBox){this.searchBox=dojo.query(".ibm-cc-search--field",this.domNode)[0];}this.searchBox.value=this.filter;},displaySearch:function(msg){try{if(msg){this.searchBox.value="";this.filter="";}}catch(e){console.error("Failed to refresh search box"+dojo.toJson(e));}},onSearch:function(evt){if(evt){dojo.stopEvent(evt);}try{if(this.searchBox.value!=this.filter){this.filter=this.searchBox.value;dojo.publish("/voices/trigger/search",[this.filter]);}}catch(e){console.error("Search error: "+dojo.toJson(e));}},onFocus:function(evt){this._onKeyPressHandle=dojo.connect(window,"onkeypress",this,function(evt){if(evt.charOrCode==dojo.keys.ENTER&&this.searchBox.value&&this.searchBox.value!=""){dojo.stopEvent(evt);dijit.focus(this.searchButton);this.onSearch();}});},onBlur:function(evt){if(this._onKeyPressHandle){dojo.disconnect(this._onKeyPressHandle);}},destroy:function(){this.inherited(arguments);if(this._onKeyPressHandle){dojo.disconnect(this._onKeyPressHandle);}}});}if(!dojo._hasResource["ibm.v17e.voices.utils.analytics"]){dojo._hasResource["ibm.v17e.voices.utils.analytics"]=true;dojo.provide("ibm.v17e.voices.utils.analytics");ibm.v17e.voices.utils.analytics={logEV:function(evt){if(ibmStats==undefined||!ibmStats){return;}if(evt==undefined||!evt){return;}try{if(this.config){evt.ibmEvModule=this.config.siteId;}ibmStats.event(evt);}catch(e){console.error(dojo.toJson(e));}},log:function(_11c,_11d,_11e,_11f){var aEvt={ibmEvGroup:_11c,ibmEV:_11d,ibmEvAction:_11e,ibmEvLinkTitle:_11f};ibm.v17e.voices.utils.analytics.logEV(aEvt);}};}if(!dojo._hasResource["ibm.v17e.voices.layer"]){dojo._hasResource["ibm.v17e.voices.layer"]=true;dojo.provide("ibm.v17e.voices.layer");dojo.addOnLoad(function(){ibm.v17e.voices.config=config;new ibm.v17e.voices.ioc(config);dojo.parser.parse();var vWid=new ibm.v17e.voices.widget.gridView({srcNodeRef:document.getElementById("ibm_cci-widget-js"),config:config});vWid.startup();});}
