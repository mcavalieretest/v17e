$(function(){function e(e,i){return e.indexOf("youtube")>-1&&(e=i),e}function i(e){var i="";return i=e.length>172?e.substring(0,170):e}window.location.hash="#voices-"+$("#ibm_cci--toggle-js li a").attr("id");var t="comma,separated,values",s=$(".ibm_cci--ls--search p"),n=$("#ibm_cci-widget-js"),a=function(e){window.location.hash||null!=window.location.hash?window.location.hash="#voices-"+e:$(location).attr("hash")+"#voices-"+e};$("ul.ibm_cci--ls--toggle--ul li").on("click","a",function(e){e.preventDefault();var i=$(e.target);i.hasClass("selected")||(i.addClass("selected").parent().siblings().children().removeClass("selected"),n.hasClass("ibm_cci-gv__modifier")?(n.removeClass("ibm_cci-gv__modifier").addClass("ibm_cci-lv__modifier"),$(".ibm_cci-lv__modifier .ibm_cci--tweet-content-text").css("display","block"),$(".ibm_cci-lv__modifier .ibm-video").css("display","none"),vo.f_checkBrowserWidth(),n.masonry("reload"),setTimeout(function(){n.masonry("reloadItems")},800)):(n.removeClass("ibm_cci-lv__modifier").addClass("ibm_cci-gv__modifier"),$(".ibm_cci-gv__modifier .ibm_cci--tweet-content-text").css("display","none"),$(".ibm_cci-gv__modifier .ibm-video").removeAttr("style"),vo.f_checkBrowserWidth(),n.masonry("reloadItems"),setTimeout(function(){n.masonry({fromBottom:!0})},800))),a(i.attr("id")),"#voices-list"===window.location.hash&&window.innerWidth>1280?($("#ibm_cci-widget-js.ibm-columns").css("width",""),n.masonry("reload")):"#voices-grid"===window.location.hash&&window.innerWidth>1280&&$("#ibm_cci-widget-js.ibm-columns").css("width","auto")}),vo.init_t({tt_url:"https://esl002.somerslab.ibm.com/social/aggregator/rest/80/VOICES/trending",t_template:$("#tt_template"),t_container:$("#ibm_cci__ml")}),vo.init_f({f_url:"https://esl002.somerslab.ibm.com/social/aggregator/rest/80/VOICES",f_container:$("#ibm_cci-widget-js"),f_unro_template:$("#unro_template"),f_reso_template:$("#reso_template")}),$.when(vo.f_fetch_trending(),vo.f_fetch_feeds()).done(function(e,i){var n=vo;n.f_checkBrowserWidth(),n.f_distribute(i),n.f_buildtiles(),n.f_removeNodes($("#ibm_cci-widget-js > span")),$("#ibm-cc-search--field").focusin(function(e){e.preventDefault(),$(".ibm_cci--ls--search p").removeClass("ibm-cci-alert").html(""),$(this).val("")}),$("form").on("submit",function(e){var i=$("#ibm-cc-search--field"),n=/^[a-zA-Z0-9 ]*$/,a=$("#ibm-cc-search--field").val().toLowerCase();if(a=a.split(","),filterVal=[],""!=a&&0!=a.length&&"comma"!=a[0])for(var r=a.length-1;r>=0;r--)n.test(a[r])?filterVal[r]=a[r].trim():(s.addClass("ibm-cci-alert").html("").append("illegal characters in search string : "+a[r]),i.val("").blur());else $(".ibm_cci--ls--search p").addClass("ibm-cci-alert").html("").append("Sorry! Search value entered is not valid!"),i.blur().val(t);i.val(""),""!=a&&0!==a&&vo.f_constructURL(filterVal.toString())}),$("li.ibm_cci__ml_t a[name='all']").on("click",function(e){return e.preventDefault(),$("p#ibm_cci__ml_t-js").hasClass("ibm_cci-clicked")?void e.preventDefault():($("li.ibm_cci__ml-li p a").removeClass("ibm_cci-close-black, ibm_cci-close"),$("li.ibm_cci__ml-li p[class='ibm_cci-clicked']").removeClass("ibm_cci-clicked"),$("p#ibm_cci__ml_t-js").addClass("ibm_cci-clicked"),$(".ibm_cci--sr > p").addClass("ibm_cci-toggleDisplay"),vo.f_removeNodes($(".ibm_cci-tsearch-js")),vo.difference=[],vo.similar=[],vo.searchterms=[],vo.sTerms=[],vo.checkedCount=0,vo.searchTrendingList=vo.searchTrendingList.slice(0,11),vo.f_fetch_feeds().done(function(e){vo.f_removeNodes($("#ibm_cci-widget-js > span"));var i=e;vo.search=!0,vo.f_distribute(i),vo.f_reTweetToggle(),$(".ibm-sortable").append($(".ibm-card")).masonry("appended",$(".ibm-card")),setTimeout(function(){$("#ibm_cci-widget-js").masonry()},400),0==vo.searchterms.length&&$(window).data("ajaxReq",!0),s.html("")}),void 0)}),$(".ibm_cci__ml-li").on("click",function(e){vo.f_addspinner();var i=$(e.target).attr("name").trim(),t=$(e.target).parent();$(t).hasClass("ibm_cci-clicked")?$(t).hasClass("ibm_cci-clicked")&&($(e.target).hasClass("ibm_cci-close-black")||($(e.target).parent("p").removeClass("ibm_cci-clicked"),$(e.target).hasClass("ibm_cci-close")?$(e.target).removeClass("ibm_cci-close"):$(e.target).siblings("a").removeClass("ibm_cci-close"),vo.searchterms=$.grep(vo.searchterms,function(e,t){return e!=i}),vo.difference=[],vo.similar=[],$(".ibm_cci--sr > p").addClass("ibm_cci-toggleDisplay"),vo.f_constructURL(vo.searchterms.toString()),s.html(""))):($(e.target).parent("p").addClass("ibm_cci-clicked"),$(e.target).siblings("a").addClass("ibm_cci-close"),$("#ibm_cci__ml_t-js").removeClass("ibm_cci-clicked"),vo.f_constructURL(i.toString()),s.html(""))}),$(".ibm_cci__ml").on("click",".ibm_cci__ml-li.ibm_cci-tsearch-js",function(e){if($(e.target).hasClass("ibm_cci-close-black")||$(e.target).hasClass("ibm_cci-voices-search-term")){var i=$(e.target).attr("name").trim();vo.searchterms=$.grep(vo.searchterms,function(e,t){return e!=i||null}),vo.searchTrendingList=$.grep(vo.searchTrendingList,function(e,t){return e!=i||null}),$(".ibm_cci--sr > p").addClass("ibm_cci-toggleDisplay"),vo.f_removeNodes($(e.target).parent().parent("li.ibm_cci__ml-li.ibm_cci-tsearch-js")),vo.difference=[],vo.similar=[],vo.search=!0,vo.f_constructURL(vo.searchterms.toString()),vo.checkedCount=0,s.html("")}}),vo.f_reTweetToggle()}),$(window).data("ajaxReq",!0).on("scroll",function(e){if(0!=$(window).data("ajaxReq"))try{var i=$(document).height()-900;if($(window).scrollTop()+$(window).height()>=$(document).height()-900&&$(window).data("ajaxReq",!0)){$(window).data("ajaxReq",!1);var t=$("#ibm_cci-widget-js .ibm-card").last().attr("data-rank");$.ajax({url:vo.f_url+"?callback=?",type:"GET",contentType:"application/json",dataType:"jsonp",data:{rank:t,noOfItems:20,filter:vo.f_checkSearchstatus(vo.search)},success:function(){}}).done(function(e){vo.dataCards=$(".ibm-card"),e.entries&&(vo.search=!1,vo.f_distribute(e),vo.f_reTweetToggle(),$(".ibm-sortable").imagesLoaded(function(){$(".ibm-sortable").append($(".ibm-card")).masonry("appended",$(".ibm-card")),$(".ibm-sortable").masonry("reload")}),setTimeout(function(){e.entries.length>=20?$(window).data("ajaxReq",!0):$(window).data("ajaxReq",!1)},100))}).fail(function(){}).always(function(){})}else $(window).scrollTop()>800?vo.f_gotoTop():$(window).scrollTop()<200&&vo.f_gotoTop()}catch(e){console.log("infinite all trending scroll error: "+e)}}).on("resize",function(){var e=$(window).height();ibmsortable=$(".ibm-sortable"),($(window).width()<=500||$(window).width()<=800)&&(ibmsortable.imagesLoaded(function(){ibmsortable.append($(".ibm-card")).masonry("appended",$(".ibm-card")),ibmsortable.masonry("reload")}),vo.f_removeNodes($("#ibm_cci-widget-js > span"))),$(window).width()<=500&&$("#ibm_cci-widget-js").hasClass("ibm_cci-lv__modifier")&&($("#ibm_cci-widget-js").removeClass("ibm_cci-lv__modifier").addClass("ibm_cci-gv__modifier"),$(".ibm_cci--ls--toggle--li--list-icon a").removeClass("selected"),$(".ibm_cci--ls--toggle--li--grid-icon a").addClass("selected"),vo.f_removeNodes($("#ibm_cci-widget-js > span"))),vo.f_checkBrowserWidth(),"#voices-list"===window.location.hash&&window.innerWidth>1280?($("#ibm_cci-widget-js.ibm-columns").css("width",""),n.masonry("reload")):"#voices-grid"===window.location.hash&&window.innerWidth>1280?$("#ibm_cci-widget-js.ibm-columns").css("width","auto"):"#voices-grid"===window.location.hash&&window.innerWidth<1280&&($("#ibm_cci-widget-js.ibm-columns").css("width",""),$("#ibm_cci-widget-js.ibm-columns").css("margin-left",""),n.masonry("reload"))}),$.views.helpers({mediaURL:e,truncateDesc:i})}),function(e,i){var t={searchterms:[],differenceClone:[],searchTrendingList:[],sTerms:[],checkedCount:0,var_rank:0,search:!0,init_t:function(e){this.t_url=e.tt_url,this.t_template=e.t_template,this.t_container=e.t_container},t_attach_template:function(e){var i=e;this.t_container.append(this.t_template.render(i))},st_attach_template:function(i){var t=i;this.t_container.append(e("#st_template").render(t))},f_checkSearchstatus:function(e){try{return 1==e?(console.log(1==e),null):t.searchterms.toString()}catch(i){console.log("check searchStatus error: "+i)}},f_fetch_trending:function(){var i=this,t=i.t_url;e.getJSON(t+"?callback=?",{type:"GET",dataType:"jsop",contentType:"application/json"},function(t){if(t&&t.trending&&t.trending.indexOf(",")>-1){var s=t.trending.trim()||null;s=e.makeArray(s),i.trendinglist=s[0].split(",")}i.t_newlist=e.map(s[0].split(","),function(i,t){return{t_list:e.makeArray(i)}}),i.searchTrendingList=i.trendinglist.slice(0),i.t_attach_template(i.t_newlist)}).promise()},init_f:function(e){this.f_url=e.f_url,this.f_unro_template=e.f_unro_template,this.f_container=e.f_container,this.f_reso_template=e.f_reso_template},f_attach_reso_temp:function(e){this.f_container.append(this.f_reso_template.render(this.f_modify_datafeed(e)))},f_attach_unro_temp:function(e){this.f_container.append(this.f_unro_template.render(this.f_modify_datafeed(e)))},f_modify_datafeed:function(i){var t=this,s=i||null;try{if(""==s||void 0==s){var n=e(".ibm_cci--sr p");n.append("Data not available")}if(s&&(s.rank=this.f_mod_rank(s.rank||""),s.content=this.f_mod_content(s.content||""),s.published=this.f_pretty_date(s.published||""),s.domain=this.f_truncateDomain(s.domain||""),(s.mediaURL||s.altMediaURL)&&(s.mediaURL=this.f_preloadImages(s.mediaURL||""),s.altMediaURL=this.f_preloadImages(s.altMediaURL||"")),s.refTweets&&s.refTweets.length>0))for(var a=0;a<s.refTweets.length;a++)s.refTweets[a].content&&(s.refTweets[a].content=this.f_mod_content(s.refTweets[a].content||""),s.refTweets[a].published=this.f_pretty_date(s.refTweets[a].published||"")),(s.userAvatar||s.refTweets.userAvatar)&&(s.userAvatar=this.f_preloadImages(s.userAvatar||""),s.refTweets[a].userAvatar=this.f_preloadImages(s.refTweets[a].userAvatar||""));return s}catch(r){console.log("Error inside the modify_datafeed: "+r)}},f_mod_rank:function(e){var i=0;return i=10>e?"0"+e:e},f_preloadImages:function(e){var i=new Image,t=0;try{if(e.length>0&&""!=e&&4!==i.readyState)return i.src=e,i.onload=function(){i.naturalWidth>0&&(t=i.naturalWidth)},i.src=e}catch(s){console.log("error inside preload images: "+s)}},f_truncateDomain:function(e){return e.indexOf(".com")>-1&&(e=e.replace(".com","")),e.indexOf("www.")>-1&&(e=e.replace("www.","")),e.indexOf(".net")>-1&&(e=e.replace(".net.","")),e.indexOf(".org")>-1&&(e=e.replace(".org","")),e.length>20&&(e=e.substring(0,20)),e},f_mod_content:function(e){var i=e.replace(/(http(s)*\:\/\/[^\s]+\s*)/g,'<a href="$1">$1</a>').replace(/#([^\s]+)/g,'<a href="//twitter.com/search?q=%23$1">#$1</a>').replace(/@([^\s:]+)/g,'<a href="//twitter.com/$1">@$1</a>');return i},f_pretty_date:function(e){try{var i=new Array;i[0]="Jan",i[1]="Feb",i[2]="Mar",i[3]="Apr",i[4]="May",i[5]="Jun",i[6]="Jul",i[7]="Aug",i[8]="Sep",i[9]="Oct",i[10]="Nov",i[11]="Dec",i[12]="December",e+="";var t=new Date(parseInt(e.trim())||""),s=((new Date).getTime()-t.getTime())/1e3,n=Math.floor(s/86400);if(isNaN(n)||0>n)return;var a=0==n&&(60>s&&"just now"||120>s&&"1m"||3600>s&&Math.floor(s/60)+"m"||7200>s&&"1h"||86400>s&&Math.floor(s/3600)+"h")||n>=1&&n+"d";return a}catch(r){console.log("error inside the f_pretty_data function: "+r)}},f_addspinner:function(){e("#ibm_cci-widget-js").append('<span class="ibm-spinner-small"></span>')},f_fetch_feeds:function(){var i=this,t=i.f_url;return i.f_addspinner(),e.ajax({url:t+"?callback=?",type:"GET",contentType:"application/json",dataType:"jsonp",data:{rank:i.var_rank,noOfItems:40,filter:i.searchterms.toString()||null}}).promise()},f_distribute:function(i){var s=this;s.widgetNodes=e("#ibm_cci-widget-js").children(".ibm-col-1-1"),t.search&&t.f_removeNodes(s.widgetNodes);try{i.entries?(s.feed=i.entries,s.feed_length=i.entries.length||0):(s.feed=i[0].entries,s.feed_length=i[0].entries.length||0)}catch(n){console.log("testing f_distribute"+n)}try{if(s.feed)for(var a=0;a<s.feed_length;a++)s.feed[a].type&&"URLREF"===s.feed[a].type?s.f_attach_reso_temp(s.feed[a]):s.feed[a].type&&"TWEET"===s.feed[a].type&&s.f_attach_unro_temp(s.feed[a])}catch(n){console.log("Error logged in the DOM ready $.when: "+n)}},f_removeNodes:function(e){e.remove()},f_totalSearchCount:function(i){var t=e(".ibm_cci--sr > p");t.text("Results found: "+i).removeClass("ibm_cci-toggleDisplay")},f_buildtiles:function(){var i=e(".ibm-sortable"),t=i.find(".ibm-card");i.imagesLoaded(function(){i.masonry({gutter:0,itemSelector:".ibm-card",transitionDuration:"10s"},!0)})},f_appendTrendinglist:function(i){var s=this;if(s.sTerms=[],s.sTerms.push(i),s.similar=[],s.difference=[],t.search){e.grep(s.sTerms[0],function(i,t){if(-1!==e.inArray(i,s.searchTrendingList)){if(0==s.similar.length)s.similar.push(i);else if(s.similar.length>0){if(-1!==e.inArray(i,s.similar))return!1;-1===e.inArray(i,s.similar)&&s.similar.push(i)}}else if(-1===e.inArray(i,s.searchTrendingList))if(0==s.difference.length)s.difference.push(i);else if(s.difference.length>0){if(-1!==e.inArray(i,s.difference))return!1;-1===e.inArray(i,s.difference)&&s.difference.push(i)}}),e.grep(s.difference,function(i,t){return-1!==e.inArray(i,s.searchTrendingList)?!1:void(-1===e.inArray(i,s.searchTrendingList)&&(s.searchTrendingList.push(i),s.differenceClone.push(s.difference)))}),s.newSearchTermList=e.map(s.difference,function(i,t){return{t_list:e.makeArray(i)}});var n=e(".ibm_cci__ml-li a.ibm_cci-voices-tt-text");try{for(var a=0;a<n.length;a++)for(var r=0;r<s.similar.length;r++)s.similar[r]==n[a].text&&(e(n[a]).parent().addClass("ibm_cci-clicked"),e(n[a]).siblings().addClass("ibm_cci-close"),e("#ibm_cci__ml_t-js").hasClass("ibm_cci-clicked")&&e("#ibm_cci__ml_t-js").removeClass("ibm_cci-clicked"))}catch(o){console.log("error in f_appendTrendinglist"+o)}e("#ibm_cci__ml_t-js").removeClass("ibm_cci-clicked"),s.st_attach_template(s.newSearchTermList),s.search=!1}},f_constructURL:function(i){var s=this;try{if(0===i.length)t.f_fetch_feeds().done(function(i){t.f_removeNodes(e("#ibm_cci-widget-js > span")),t.search=!0,t.f_distribute(i),t.f_reTweetToggle(),e("#ibm_cci__ml_t-js").addClass("ibm_cci-clicked"),e("#ibm_cci-widget-js").masonry("reload"),setTimeout(function(){e("#ibm_cci-widget-js").masonry()},400)}),0==t.searchterms.length&&e(window).data("ajaxReq",!0);else if(i.length>0){s.filter_searchterms=[];for(var n=i.trim().split(","),a=0;a<n.length;a++)s.filter_searchterms.push(n[a]);e.grep(s.filter_searchterms,function(i,t){-1===e.inArray(i,s.searchterms)&&s.searchterms.push(i)}),e.unique(s.searchterms),e.ajax(s.f_url+"?callback=?",{type:"GET",dataType:"jsonp",contentType:"application/json",data:{rank:s.var_rank,noOfItems:20,filter:s.searchterms.toString()},success:function(){}}).done(function(i,s,n){var a=t;if(i.terms){if(!(i.terms.length>0))return;t.search=!0,t.f_distribute(i),t.f_reTweetToggle(),t.totalSearchCountNum=i.totalCount||0,t.f_totalSearchCount(i.totalCount),t.f_appendTrendinglist(e.makeArray(i.terms.split(","))),t.checkedCount=i.terms.split(",").length,t.f_removeNodes(e("#ibm_cci-widget-js > span")),e(".ibm-sortable").append(e(".ibm-card")).masonry("appended",e(".ibm-card")),setTimeout(function(){e("#ibm_cci-widget-js").masonry()},400),t.searchterms.length>0&&e(window).data("ajaxReq",!0)}}).fail(function(){}).always(function(){})}}catch(r){console.log("error inside f_constructURL"+r)}},f_reTweetToggle:function(){try{e("#ibm_cci-widget-js ul.ibm_cci-relatedTweetContainer li").on("click","a",function(i){i.preventDefault();var t=e(this);parent_dataID=t.parent().data("userid"),targetDiv=t.parentsUntil("div.ibm-col-1-1").children('div[data-userid="'+parent_dataID+'"]'),t.children("img").hasClass("selected")||(t.parent("li").siblings("li").find("a img").removeClass("selected"),t.children("img").addClass("selected"),t.parentsUntil("div.ibm-col-1-1").children("div").css("display","none"),targetDiv.css("display","visible"),e(".ibm-sortable").masonry("reload"))})}catch(i){console.log("error in f_reTweetToggle function: "+i)}},f_checkBrowserWidth:function(){var i=t,s=window.innerWidth,n=window.location.hash,a=i.f_calculateFluidMargin();0!==a?a-=10:0===a&&(a+=150),"#voices-grid"===window.location.hash&&window.innerWidth>1280&&(e("#ibm_cci-widget-js.ibm-columns").css("margin-left",a),e("#ibm_cci-widget-js.ibm-columns").css("width","auto"))},f_calculateFluidMargin:function(){var i=e("#ibm_cci-widget-js").outerWidth(!0);return i%320/2},f_gotoTop:function(){var i=e("#ibm_cci-gototop-js"),t=e(window).scrollTop(),s=e(window).height(),n=e(document).height()-900;t>400?e(i).css({opacity:1,visibility:"visible"}).animate("slow"):200>t&&(console.log("trigerred inside else scrolltop: "+t),e(i).css({opacity:0,visibility:"hidden"}).animate("slow")),i.on("click",function(i){i.preventDefault(),e("html, body").stop(!0).animate({scrollTop:0},"slow")})}};i.vo=t}(jQuery,window),function(e,i,t,s){"use strict";var n=i.event,a;n.special.smartresize={setup:function(){i(this).bind("resize",n.special.smartresize.handler)},teardown:function(){i(this).unbind("resize",n.special.smartresize.handler)},handler:function(e,i){var t=this,s=arguments;e.type="smartresize",a&&clearTimeout(a),a=setTimeout(function(){n.dispatch.apply(t,s)},"execAsap"===i?0:100)}},i.fn.smartresize=function(e){return e?this.bind("smartresize",e):this.trigger("smartresize",["execAsap"])},i.Mason=function(e,t){this.element=i(t),this._create(e),this._init()},i.Mason.settings={isResizable:!0,isAnimated:!1,animationOptions:{queue:!1,duration:500},gutterWidth:0,isRTL:!1,isFitWidth:!1,containerStyle:{position:"relative"}},i.Mason.prototype={_filterFindBricks:function(e){var i=this.options.itemSelector;return i?e.filter(i).add(e.find(i)):e},_getBricks:function(e){var i=this._filterFindBricks(e).css({position:"absolute"}).addClass("masonry-brick");return i},_create:function(t){this.options=i.extend(!0,{},i.Mason.settings,t),this.styleQueue=[];var s=this.element[0].style;this.originalStyle={height:s.height||""};var n=this.options.containerStyle;for(var a in n)this.originalStyle[a]=s[a]||"";this.element.css(n),this.horizontalDirection=this.options.isRTL?"right":"left";var r=this.element.css("padding-"+this.horizontalDirection),o=this.element.css("padding-top");this.offset={x:r?parseInt(r,10):0,y:o?parseInt(o,10):0},this.isFluid=this.options.columnWidth&&"function"==typeof this.options.columnWidth;var c=this;setTimeout(function(){c.element.addClass("masonry")},0),this.options.isResizable&&i(e).bind("smartresize.masonry",function(){c.resize()}),this.reloadItems()},_init:function(e){this._getColumns(),this._reLayout(e)},option:function(e,t){i.isPlainObject(e)&&(this.options=i.extend(!0,this.options,e))},layout:function(e,i){for(var t=0,s=e.length;s>t;t++)this._placeBrick(e[t]);var n={};if(n.height=Math.max.apply(Math,this.colYs),this.options.isFitWidth){var a=0;for(t=this.cols;--t&&0===this.colYs[t];)a++;n.width=(this.cols-a)*this.columnWidth-this.options.gutterWidth}this.styleQueue.push({$el:this.element,style:n});var r=this.isLaidOut?this.options.isAnimated?"animate":"css":"css",o=this.options.animationOptions,c;for(t=0,s=this.styleQueue.length;s>t;t++)c=this.styleQueue[t],c.$el[r](c.style,o);this.styleQueue=[],i&&i.call(e),this.isLaidOut=!0},_getColumns:function(){var e=this.options.isFitWidth?this.element.parent():this.element,i=e.width();this.columnWidth=this.isFluid?this.options.columnWidth(i):this.options.columnWidth||this.$bricks.outerWidth(!0)||i,this.columnWidth+=this.options.gutterWidth,this.cols=Math.floor((i+this.options.gutterWidth)/this.columnWidth),this.cols=Math.max(this.cols,1)},_placeBrick:function(e){var t=i(e),s,n,a,r,o;if(s=Math.ceil(t.outerWidth(!0)/this.columnWidth),s=Math.min(s,this.cols),1===s)a=this.colYs;else for(n=this.cols+1-s,a=[],o=0;n>o;o++)r=this.colYs.slice(o,o+s),a[o]=Math.max.apply(Math,r);for(var c=Math.min.apply(Math,a),l=0,d=0,m=a.length;m>d;d++)if(a[d]===c){l=d;break}var h={top:c+this.offset.y};h[this.horizontalDirection]=this.columnWidth*l+this.offset.x,this.styleQueue.push({$el:t,style:h});var f=c+t.outerHeight(!0),_=this.cols+1-m;for(d=0;_>d;d++)this.colYs[l+d]=f},resize:function(){var e=this.cols;this._getColumns(),(this.isFluid||this.cols!==e)&&this._reLayout()},_reLayout:function(e){var i=this.cols;for(this.colYs=[];i--;)this.colYs.push(0);this.layout(this.$bricks,e)},reloadItems:function(){this.$bricks=this._getBricks(this.element.children())},reload:function(e){this.reloadItems(),this._init(e)},appended:function(e,i,t){if(i){this._filterFindBricks(e).css({top:this.element.height()});var s=this;setTimeout(function(){s._appended(e,t)},1)}else this._appended(e,t)},_appended:function(e,i){var t=this._getBricks(e);this.$bricks=this.$bricks.add(t),this.layout(t,i)},remove:function(e){this.$bricks=this.$bricks.not(e),e.remove()},destroy:function(){this.$bricks.removeClass("masonry-brick").each(function(){this.style.position="",this.style.top="",this.style.left=""});var t=this.element[0].style;for(var s in this.originalStyle)t[s]=this.originalStyle[s];this.element.unbind(".masonry").removeClass("masonry").removeData("masonry"),i(e).unbind(".masonry")}},i.fn.imagesLoaded=function(e){function t(){e.call(n,a)}function s(e){var n=e.target;n.src!==o&&-1===i.inArray(n,c)&&(c.push(n),--r<=0&&(setTimeout(t),a.unbind(".imagesLoaded",s)))}var n=this,a=n.find("img").add(n.filter("img")),r=a.length,o="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==",c=[];return r||t(),a.bind("load.imagesLoaded error.imagesLoaded",s).each(function(){var e=this.src;this.src=o,this.src=e}),n};var r=function(i){e.console&&e.console.error(i)};i.fn.masonry=function(e){if("string"==typeof e){var t=Array.prototype.slice.call(arguments,1);this.each(function(){var s=i.data(this,"masonry");return s?i.isFunction(s[e])&&"_"!==e.charAt(0)?void s[e].apply(s,t):void r("no such method '"+e+"' for masonry instance"):void r("cannot call methods on masonry prior to initialization; attempted to call method '"+e+"'")})}else this.each(function(){var t=i.data(this,"masonry");t?(t.option(e||{}),t._init()):i.data(this,"masonry",new i.Mason(e,this))});return this}}(window,jQuery,vo);